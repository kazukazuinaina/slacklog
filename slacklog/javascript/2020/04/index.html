---
# vim:set ts=2 sts=2 sw=2 et:
layout: slacklog
title: vim-jp.slack.com log - &#35javascript - 2020年04月
---
<div>
<h2><a href='{{ post.url }}'>{{ page.title }}</a></h2>

<p>参加方法、各チャンネルの概要等は以下を参照して下さい。<br>
<a href='/docs/chat.html'>vim-jpのチャットルームについて</a></p>

{% raw %}
<pre>nao 1日 17:41:43: （今更）
&gt; [...document.querySelectorAll(“div”)].map(x =&gt; x.nodeName) 
脳死で `[].slice.apply(document.querySelectorAll("div")).map(function(x) { return x.nodeName;})` してました。困ったときの `[].slice.apply` による配列化はよくやります。</pre>
<pre>nao 1日 17:44:05: 丁寧にやると `Array.prototype.slice.apply(document.querySelectorAll("div"))`</pre>
<pre>tyru 1日 18:20:27: 見慣れた `Array.prototype.slice.call(arguments)`
使えない環境考えるなら Array.from の polyfill 書くのが一番いい気がする</pre>
<pre>ゴリラ 6日 12:54:33: jsって `;`があるなしで挙動が変わる…？
<https://qiita.com/otthi/items/ceec62d5a117678649e9></pre>
<pre>thinca 6日 12:55:00: 変わる</pre>
<pre>ゴリラ 6日 12:55:11: しらんかった</pre>
<pre>ゴリラ 6日 12:55:16: 基本 ; を付けたほうが良いのか</pre>
<pre>ycino 6日 12:55:44: 変わります、最近不要になっている風潮なのはprettierとかの整形プラグインが挙動が変わるのを検知して必要なセミコロンを追加してくれるように十分成熟しているから</pre>
<pre>heavenshell 6日 12:55:46: トランスパイラーが勝手に付ける</pre>
<pre>thinca 6日 12:55:49: この辺りは派閥がどちらもあります</pre>
<pre>thinca 6日 12:56:16: 私は付ける派。なんとなくだけど古くから書いてる人は付けるイメージがある。実際どうかはわからんけど</pre>
<pre>ycino 6日 12:56:30: なくてもプラグインが矯正してくれて支障なくなってるんですよね</pre>
<pre>ゴリラ 6日 12:56:33: `;` をつけると安心感はあるな（自分のなか</pre>
<pre>ゴリラ 6日 12:56:53: prettier にそのルールを付けよ</pre>
<pre>thinca 6日 12:57:00: 言語製作者の意図を尊重して付けている</pre>
<pre>ycino 6日 12:57:21: 今のprettierのデフォルトルールって付けるのと付けないのどっちでしたっけ</pre>
<pre>heavenshell 6日 12:57:33: 自分はつけないけど、prettier を尊重してる</pre>
<pre>heavenshell 6日 12:58:36: <https://prettier.io/docs/en/options.html#semicolons></pre>
<pre>heavenshell 6日 12:58:41: default True かな。</pre>
<pre>thinca 6日 12:58:47: JavaScript における `;` の省略は、うっかり書き忘れた時でもなんとなく動くようにするため (ブラウザで動くのあってか、全体的に適当に書いても動く方向に倒されていた) であって、省略して書く方法はこの機能を悪用していると言える</pre>
<pre>ycino 6日 12:59:17: デフォルト有効か</pre>
<pre>ycino 6日 13:00:11: 元は悪用でも、一般的なルールになってきてる内容だったら自分はそこまで原理主義的に考えなくてもいい派</pre>
<pre>thinca 6日 13:00:28: `"use strict"` した時に省略したらエラーになるようにしていれば派閥分かれなかったと思う
と思ったけど `"use strict"` 読んだ時点でパースは終わってるから無理か…</pre>
<pre>heavenshell 6日 13:02:07: standard 教徒だったので。多分いろんな人は発狂すると思うw</pre>
<pre>ycino 6日 13:02:14: Googleのstandardが無効とかでしたっけ、なんか割と大きいとこが無効にしたから流行りましたよね</pre>
<pre>heavenshell 6日 13:02:23: `function foo () { }` とかね。</pre>
<pre>ycino 6日 13:02:27: airbnbは有効だった印象</pre>
<pre>thinca 6日 13:03:07: 割とどうでもいいところで疲弊したくないよなぁ</pre>
<pre>kuu 6日 13:03:44: 悪用する人が多いと迂闊に消せなくてクソみたいな仕様が残るのでクソつらい:shit:</pre>
<pre>ycino 6日 13:03:49: JSに関してはprettierさえ入れちゃえば脳死して書けるから疲弊しなくないです？
Rubyの方が疲れる・・・</pre>
<pre>thinca 6日 13:04:16: prettier 挙動が好きじゃないので使ってない</pre>
<pre>thinca 6日 13:04:49: これは単に私は JS に関しては個人開発しかしてないからと言う事情がある。チームだったらさすがに使う気がする</pre>
<pre>heavenshell 6日 13:05:07: 個人ならお好きに。チームなら使えや！って言うかな。</pre>
<pre>ゴリラ 6日 13:05:21: チームは、使ったほうが良いと思っていますね</pre>
<pre>heavenshell 6日 13:05:32: と言うか lint-staged と husky 入れて終わる。</pre>
<pre>ゴリラ 6日 13:05:33: 使ってくれないなら、 ウホウホって言います</pre>
<pre>thinca 6日 13:08:52: Ruby は緩くやってるチームが多そう。そうせざるを得ない感じもあるけど</pre>
<pre>heavenshell 6日 13:09:53: Robocop でしたっけ？アレ入れてガチガチにやってるイメージなんですけど、そうでもないんですね。</pre>
<pre>thinca 6日 13:10:51: RuboCop は Linter であって Formatter ではないので</pre>
<pre>ycino 6日 13:10:57: prettierの方がフォーマッタとしてはサポートしてる範囲が相当広いですね</pre>
<pre>ycino 6日 13:11:20: format機能も付いてますけど、完全に信頼出来るものではないというか</pre>
<pre>thinca 6日 13:11:41: Auto Correct 機能は付いてますが Format 機能はないです</pre>
<pre>ycino 6日 13:11:58: あー、確かに
あれはformatではないのか</pre>
<pre>thinca 6日 13:12:05: ではないですね</pre>
<pre>ycino 6日 13:12:18: メトリクスあたりはすごい丁寧に測ってくれるんですけどね</pre>
<pre>heavenshell 6日 13:12:27: なるほど</pre>
<pre>ycino 6日 13:12:27: prettierとは軸が全然違う感じ</pre>
<pre>thinca 6日 13:13:09: ある Cop (Lint ルール) が Auto Correct した結果が別の Cop にとっては間違ったコードになっている、みたいなことはザラに起きる</pre>
<pre>ycino 6日 13:13:28: <https://github.com/ruby-formatter/rufo> がデファクトになってほしいってずっと言ってる</pre>
<pre>ycino 6日 13:14:07: StyleのCopについてはFormatterと言ってもいいような感じはある</pre>
<pre>mattn 6日 13:14:11: efm には入れてる。</pre>
<pre>thinca 6日 13:14:46: たまに人の手による温かみのある桁揃えがされたコードとかがあって、この辺り勝手に直すの申し訳ないなって気持ちになってつらい (なお個人的には桁揃えはしない派)</pre>
<pre>thinca 6日 13:15:06: prettier はやっぱり桁揃えは全部消されちゃうんですかね</pre>
<pre>ycino 6日 13:15:13: 消されますね</pre>
<pre>thinca 6日 13:15:20: まーそうですよねー</pre>
<pre>ycino 6日 13:15:30: 誰が書いても絶対全く同じ書き方になるから便利ってやつなので</pre>
<pre>kuu 6日 13:15:50: gofmtと同じ思想か</pre>
<pre>ycino 6日 13:16:08: eslint-plugin-prettierでlinterで弾くのが結構使われてて、沿ってないとCIで落ちる</pre>
<pre>thinca 6日 13:16:22: たまにめっちゃ読みづらいコードにフォーマットしてきて憤慨するので使わなくなった</pre>
<pre>ycino 6日 13:17:04: それはわかる、自分はそれを差し引いても有用だと判断して使ってますが</pre>
<pre>thinca 6日 13:18:21: チームで JS 書くことになったら使う…今はその予定はない…困るとしたら PR 飛んできた時かなぁ</pre>
<pre>ycino 6日 13:23:42: 人が多そうなんで全く別件で聞きたいんですけど
以下のコードでActionがswitchケースを網羅してるか型でチェックするみたいなのをやってるんですけど
```type Action = A | B

const reducer = (action: Action) =&gt; {
  switch (action) {
    case A: {
      return
    }
    case B: {
      return
    }
    default: {
      const _: never = action
    }
  }
}```</pre>
<pre>ycino 6日 13:24:42: Union型じゃないと `action` の型が `never` に確定されないの、どうしようもないですよねぇ
```type Action = A

const reducer = (action: Action) =&gt; {
  switch (action) {
    case A: {
      return
    }
    default: {
      const _: never = action
    }
  }
}```</pre>
<pre>ycino 6日 13:32:02: `A | never` 多分ダメそう・・・</pre>
<pre>johejo 6日 13:50:41: reduxだ...</pre>
<pre>lambdalisue 6日 13:59:46: 疑問点がよくわかっていない</pre>
<pre>lambdalisue 6日 13:59:58: ```type Action = "A";

const r = (action: Action) =&gt; {
  switch (action) {
    case "A": {
      return "Hello";
    }
    default: {
      const _: never = action;
    }
  }
};```</pre>
<pre>lambdalisue 6日 14:00:25: 怒られない = 正しい</pre>
<pre>lambdalisue 6日 14:00:39: ```type Action = "A" | "B";

const r = (action: Action) =&gt; {
  switch (action) {
    case "A": {
      return "Hello";
    }
    default: {
      const _: never = action;
    }
  }
};```</pre>
<pre>ycino 6日 14:00:40: 前者だとdefault区でactionの型がneverに推論されてて、後者だとAに推論されませんか？</pre>
<pre>lambdalisue 6日 14:00:45: 怒られる = 正しく無い</pre>
<pre>lambdalisue 6日 14:00:59: ```type Action = "A" | "B";

const r = (action: Action) =&gt; {
  switch (action) {
    case "A": {
      return "Hello";
    }
    case "B": {
      return "Hello";
    }
    default: {
      const _: never = action;
    }
  }
};```</pre>
<pre>lambdalisue 6日 14:01:03: 怒られない = 正しい</pre>
<pre>ycino 6日 14:01:05: 期待としてはどっちもdefault区でactionの型がneverに推論されて欲しい</pre>
<pre>lambdalisue 6日 14:02:43: never になる...</pre>
<pre>ycino 6日 14:02:57: えっ</pre>
<pre> 6日 14:02:58: </pre>
<pre>ycino 6日 14:03:13: マジか、挙動変わった・・・？</pre>
<pre>ycino 6日 14:03:15: それなら嬉しい</pre>
<pre>ycino 6日 14:03:47: 最近試してダメだったんだけど、プロジェクトのTSが古かったかも</pre>
<pre> 6日 14:04:18: </pre>
<pre> 6日 14:04:41: </pre>
<pre>lambdalisue 6日 14:04:48: なので網羅性チャックもちゃんと出来てると思います</pre>
<pre>lambdalisue 6日 14:04:53: チャック</pre>
<pre>lambdalisue 6日 14:05:00: :zipper_mouth_face:</pre>
<pre>ycino 6日 14:05:15: でもこれで少し書きやすくなるなー</pre>
<pre>luma 6日 14:25:52: セミコロンなし，行頭で括弧を使うと前の行の関数実行になってしまい，そこだけつけるのも統一感ないので，けっこうすきだったけどやめた...行単位での交換とかもできなくなるし，などで

```a.b()
(c.d).f
(c as X).f```</pre>
<pre>ゴリラ 6日 15:06:17: VimでJavaScriptをする部屋</pre>
{% endraw %}
