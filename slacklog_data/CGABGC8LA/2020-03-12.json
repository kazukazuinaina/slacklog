[{"client_msg_id":"a0760486-198e-4cf4-9b01-b25e4239aefa","type":"message","text":"明日(っていうか明けて今日)、1.14でコンパイルしたプログラムがVSZを馬鹿みたいに要求する件をもうちょっと深堀する予定。","user":"U06BRP8VD","ts":"1583939034.292800","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"6dS+M","elements":[{"elements":[{"text":"明日(っていうか明けて今日)、1.14でコンパイルしたプログラムがVSZを馬鹿みたいに要求する件をもうちょっと深堀する予定。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}],"reactions":[{"name":"+1smile","users":["U0M7GCBPD","UGXMRNBUM"],"count":2},{"name":"+1","users":["UDDCM376D","UGXMRNBUM"],"count":2}]},{"client_msg_id":"3ca5979f-0a5b-46ac-85a3-b37c3a98c361","type":"message","text":"golangがmmapの失敗=VSZの確保失敗でしか正しくメモリ枯渇を検出できない以上は、いっぺんに1GBも確保しようとするのはあまりに取り回しがしにくいとなった。","user":"U06BRP8VD","ts":"1583939171.294400","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"qFXTF","elements":[{"elements":[{"text":"golangがmmapの失敗=VSZの確保失敗でしか正しくメモリ枯渇を検出できない以上は、いっぺんに1GBも確保しようとするのはあまりに取り回しがしにくいとなった。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"349ca98b-eabd-4933-86f0-6d5bd4d5139c","type":"message","text":"<https://github.com/golang/go/issues/26460>\n\n... oh... 変なバグを踏み抜いた…","user":"UGXMRNBUM","ts":"1583970367.295300","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","attachments":[{"service_name":"GitHub","title":"testing: examples with trailing whitespace in multiple lines of output can be confusing · Issue #26460 · golang/go","title_link":"https://github.com/golang/go/issues/26460","text":"Below example fails. Even if I copy the output of go test to the output section, it still fails. func ExampleTrailingSpace() { fmt.Println(&amp;quot;abc &amp;quot;) fmt.Println(&amp;quot;cde&amp;quot;) // Output: ...","fallback":"GitHub: testing: examples with trailing whitespace in multiple lines of output can be confusing · Issue #26460 · golang/go","thumb_url":"https://avatars3.githubusercontent.com/u/4314092?s=400&v=4","from_url":"https://github.com/golang/go/issues/26460","thumb_width":400,"thumb_height":400,"service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","id":1,"original_url":"https://github.com/golang/go/issues/26460"}],"blocks":[{"block_id":"lqhs","elements":[{"elements":[{"type":"link","url":"https://github.com/golang/go/issues/26460"},{"text":"\n\n... oh... 変なバグを踏み抜いた…","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"8ed6b44b-4548-44a1-9be6-2a4838a5d3b0","type":"message","text":"<https://github.com/golang/go/wiki/LinuxKernelSignalVectorBug>","user":"U03C6TEAZ","ts":"1583988746.295800","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","attachments":[{"service_name":"GitHub","title":"golang/go","title_link":"https://github.com/golang/go/wiki/LinuxKernelSignalVectorBug","text":"The Go programming language. Contribute to golang/go development by creating an account on GitHub.","fallback":"GitHub: golang/go","thumb_url":"https://avatars3.githubusercontent.com/u/4314092?s=400&v=4","from_url":"https://github.com/golang/go/wiki/LinuxKernelSignalVectorBug","thumb_width":400,"thumb_height":400,"service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","id":1,"original_url":"https://github.com/golang/go/wiki/LinuxKernelSignalVectorBug"}],"blocks":[{"block_id":"Xrjm","elements":[{"elements":[{"type":"link","url":"https://github.com/golang/go/wiki/LinuxKernelSignalVectorBug"}],"type":"rich_text_section"}],"type":"rich_text"}],"reactions":[{"name":"eyes","users":["UNJ2DANJC","U06BRP8VD"],"count":2}]},{"client_msg_id":"396ad1b7-822e-43f1-bca9-6071b694528f","type":"message","text":"<https://go-review.googlesource.com/c/go/+/223121/>","user":"U03C6TEAZ","ts":"1583990067.296300","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","attachments":[{"service_name":"go-review.googlesource.com","text":"Gerrit Code Review","fallback":"Gerrit Code Review","from_url":"https://go-review.googlesource.com/c/go/+/223121/","service_icon":"https://go-review.googlesource.com/favicon.ico","id":1,"original_url":"https://go-review.googlesource.com/c/go/+/223121/"}],"blocks":[{"block_id":"uFw9Q","elements":[{"elements":[{"type":"link","url":"https://go-review.googlesource.com/c/go/+/223121/"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"6a990fdf-32a4-48b3-9786-4dd675773767","type":"message","text":"そろそろまとめがあがってくるころ","user":"U7H4TJEG0","ts":"1583991270.296700","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"fBt","elements":[{"elements":[{"text":"そろそろまとめがあがってくるころ","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"c6c9c80e-56ce-4751-9440-3e72a9bdfa4e","type":"message","text":"ざわっ","user":"U03C6TEAZ","ts":"1583991502.296900","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"=UB","elements":[{"elements":[{"text":"ざわっ","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"6c01db18-324e-4d73-ac4f-d5e9b426e3bb","type":"message","text":"goの1.14でビルドしたバイナリ、ulimit -v で最低VSZを探索してたらある値でSegmentation faultしたwww","user":"U06BRP8VD","ts":"1583992769.298000","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"xBgeV","elements":[{"elements":[{"text":"goの1.14でビルドしたバイナリ、ulimit -v で最低VSZを探索してたらある値でSegmentation faultしたwww","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"86fd701d-4f9a-4311-8c4e-b77fafa9ad31","type":"message","text":"これどうしよ…","user":"U06BRP8VD","ts":"1583992819.298200","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"KXqm","elements":[{"elements":[{"text":"これどうしよ…","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"7ea6307d-4f4d-44e9-b914-1cc7b9361f87","type":"message","text":"うわぁ...","user":"UAZ33BKV2","ts":"1583992937.298400","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"SMOv","elements":[{"elements":[{"text":"うわぁ...","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"398a0d3e-8edc-4da0-baa4-f7ed79cab981","type":"message","text":"コントリビュート(バグ報告)チャンス","user":"U03C71D7H","ts":"1583993045.299900","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"7a3ql","elements":[{"elements":[{"text":"コントリビュート(バグ報告)チャンス","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"bbaf426e-47c8-493e-a483-aafe8a31ceb5","type":"message","text":"`go build -v` して `ulimit -v` で制限してから `./memerr` で起動する。メモリを128MBずつ確保していくからいずれ落ちるんだけど、一定以上VSZがないと起動すらしない。その起動する最小限のVSZを探るために作った。\n\n<https://gist.github.com/koron/baaca48e007102aed46d18a82cb1b363>","user":"U06BRP8VD","ts":"1583993072.300500","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"BD9","elements":[{"elements":[{"style":{"code":true},"text":"go build -v","type":"text"},{"text":" して ","type":"text"},{"style":{"code":true},"text":"ulimit -v","type":"text"},{"text":" で制限してから ","type":"text"},{"style":{"code":true},"text":"./memerr","type":"text"},{"text":" で起動する。メモリを128MBずつ確保していくからいずれ落ちるんだけど、一定以上VSZがないと起動すらしない。その起動する最小限のVSZを探るために作った。\n\n","type":"text"},{"type":"link","url":"https://gist.github.com/koron/baaca48e007102aed46d18a82cb1b363"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"19b71033-690d-4c0e-a1cc-0849119f2574","type":"message","text":"go1.14でコンパイルした場合\n\n686MB以下だと起動できない(初期化でpanic)\n686MB でセグフォ\n687MBだと起動できない(初期化でpanic)\n688MB以上で起動できる\n\ngo1.13.8でコンパイルした場合は\n110MBあたりで動くようになる。\n\nXubuntu 19.10, Kernel は5.3.0-40-generic","user":"U06BRP8VD","ts":"1583993205.302400","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"5HT3","elements":[{"elements":[{"text":"go1.14でコンパイルした場合\n\n686MB以下だと起動できない(初期化でpanic)\n686MB でセグフォ\n687MBだと起動できない(初期化でpanic)\n688MB以上で起動できる\n\ngo1.13.8でコンパイルした場合は\n110MBあたりで動くようになる。\n\nXubuntu 19.10, Kernel は5.3.0-40-generic","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"eec5725f-bce8-4e06-a0ce-dded1c59f5de","type":"message","text":"富豪的プログラミングだ","user":"U9S4G0LJW","ts":"1583993235.302700","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"tcP/X","elements":[{"elements":[{"text":"富豪的プログラミングだ","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"20f20397-7e8a-4849-a730-e9585cc443a5","type":"message","text":"伝えた方が良さそうな気がする。","user":"U03C6TEAZ","ts":"1583993290.303000","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"6B7","elements":[{"elements":[{"text":"伝えた方が良さそうな気がする。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"96387c86-2928-4ce1-b17b-8da074cfa855","type":"message","text":"VSZ がそんだけ必要になったの気付いてない可能性ある。","user":"U03C6TEAZ","ts":"1583993301.303300","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"IhT2","elements":[{"elements":[{"text":"VSZ がそんだけ必要になったの気付いてない可能性ある。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"09578730-d9cb-4f65-b066-6a1e7e3f80e8","type":"message","text":"僕はもうちょい調べるので、先に報告してもらってもOK","user":"U06BRP8VD","ts":"1583993335.303900","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"WRTWL","elements":[{"elements":[{"text":"僕はもうちょい調べるので、先に報告してもらってもOK","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"1fb1f740-0027-4308-87f3-96739bac8cfd","type":"message","text":"ちなみに","user":"U03C6TEAZ","ts":"1583993343.304100","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"4I=b","elements":[{"elements":[{"text":"ちなみに","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"06eb687c-b0bb-4900-b409-e50e36f467e5","type":"message","text":"```GODEBUG=asyncpreemptoff=1 ./app```","user":"U03C6TEAZ","ts":"1583993348.304300","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"MW=6K","elements":[{"elements":[{"text":"GODEBUG=asyncpreemptoff=1 ./app","type":"text"}],"type":"rich_text_preformatted"}],"type":"rich_text"}]},{"client_msg_id":"feb7e03a-8fdf-44e1-a005-f111f8f303bb","type":"message","text":"でも結果同じですか？","user":"U03C6TEAZ","ts":"1583993354.304500","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"5j1n","elements":[{"elements":[{"text":"でも結果同じですか？","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"e5cb7fd4-e87d-430f-ad17-87dec8b18c81","type":"message","text":"やってみます～","user":"U06BRP8VD","ts":"1583993366.304900","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"E2tw","elements":[{"elements":[{"text":"やってみます～","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"ae5371c1-1d00-4448-9aaa-19f8b69ed4fd","type":"message","text":"僕報告しても質問返されたらよー返さんw","user":"U03C6TEAZ","ts":"1583993371.305100","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"l0Gk","elements":[{"elements":[{"text":"僕報告しても質問返されたらよー返さんw","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"72c51639-fc7f-4d5b-bce3-00179387b20d","type":"message","text":"んとりあえずおなじっぽ。","user":"U06BRP8VD","ts":"1583993422.305300","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"UbJe7","elements":[{"elements":[{"text":"んとりあえずおなじっぽ。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"a4696d20-b96e-43d8-a685-bd6c9884d408","type":"message","text":"なるほど。","user":"U03C6TEAZ","ts":"1583993457.305500","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"Rb3","elements":[{"elements":[{"text":"なるほど。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"d77bce16-d1d4-4f24-9e0f-a3472d17743d","type":"message","text":"実行したのって `docker -m 600mb` みたいな奴ですか？","user":"U03C6TEAZ","ts":"1583993560.306500","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"aS9","elements":[{"elements":[{"text":"実行したのって ","type":"text"},{"style":{"code":true},"text":"docker -m 600mb","type":"text"},{"text":" みたいな奴ですか？","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"b9b8a196-2e5f-4ead-bafa-e064e0f503f0","type":"message","text":"この `686` のところをいじりつつ、という感じ。","user":"U06BRP8VD","ts":"1583993705.306800","blocks":[{"block_id":"LX=Vj","elements":[{"elements":[{"text":"この ","type":"text"},{"style":{"code":true},"text":"686","type":"text"},{"text":" のところをいじりつつ、という感じ。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}],"files":[{"id":"FV8SEL6H2","created":1583993703,"timestamp":1583993703,"name":"Untitled.txt","title":"Untitled","mimetype":"text/plain","filetype":"text","pretty_type":"Plain Text","user":"U06BRP8VD","editable":true,"size":59,"mode":"snippet","is_external":false,"external_type":"","is_public":true,"public_url_shared":false,"display_as_bot":false,"username":"","url_private":"https://files.slack.com/files-pri/T03C4RC8V-FV8SEL6H2/Untitled.txt","url_private_download":"https://files.slack.com/files-pri/T03C4RC8V-FV8SEL6H2/download/Untitled.txt","permalink":"https://vim-jp.slack.com/files/U06BRP8VD/FV8SEL6H2/Untitled.txt","permalink_public":"https://slack-files.com/T03C4RC8V-FV8SEL6H2-819ad8ea69","edit_link":"https://vim-jp.slack.com/files/U06BRP8VD/FV8SEL6H2/Untitled.txt/edit","is_starred":false,"has_rich_preview":false}],"upload":true},{"client_msg_id":"37be4470-346c-4c85-a83b-392f509ef346","type":"message","text":"`func main() { println(\"Hello World\") }` だけでも VSZが 686MB 要るわwww","user":"U06BRP8VD","ts":"1583993858.307700","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"ds/zP","elements":[{"elements":[{"style":{"code":true},"text":"func main() { println(\"Hello World\") }","type":"text"},{"text":" だけでも VSZが 686MB 要るわwww","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"9250db87-1f6b-4678-8d5d-0d518d8ed7ae","type":"message","text":"あと src/runtime/mem_linux.go がどう呼ばれてるかだけ見てから、どう報告するか考えるか…","user":"U06BRP8VD","ts":"1583993888.308300","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"CFa","elements":[{"elements":[{"text":"あと src/runtime/mem_linux.go がどう呼ばれてるかだけ見てから、どう報告するか考えるか…","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"7f20fc81-a896-44e2-b5ef-595098421a46","type":"message","text":"ちなみにリリースバイナリですか？それとも tip？","user":"U03C6TEAZ","ts":"1583993954.308700","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"XdM","elements":[{"elements":[{"text":"ちなみにリリースバイナリですか？それとも tip？","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"d98f0016-b203-478e-876f-bf948cfffbaa","type":"message","text":"リリースバイナリです。","user":"U06BRP8VD","ts":"1583993962.308900","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"shn3","elements":[{"elements":[{"text":"リリースバイナリです。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"b0036ac1-67b4-41ac-bb73-81950166e24b","type":"message","text":"あざます。僕も試してみます。","user":"U03C6TEAZ","ts":"1583993975.309300","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"DWi","elements":[{"elements":[{"text":"あざます。僕も試してみます。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}],"reactions":[{"name":"cat-dogeza-mike","users":["U06BRP8VD"],"count":1}]},{"client_msg_id":"40a47a76-8ae5-42df-a9aa-ce5e2b9c32b3","type":"message","text":"```#!/bin/sh\n\nset -e\n\nfor i in $(seq 700 -1 600); do\n  echo $i\n  ulimit -v `expr $i \\* 1024`\n  ./helloworld\ndone```","user":"U03C6TEAZ","ts":"1583994262.309600","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"6Y3","elements":[{"elements":[{"text":"#!/bin/sh\n\nset -e\n\nfor i in $(seq 700 -1 600); do\n  echo $i\n  ulimit -v `expr $i \\* 1024`\n  ./helloworld\ndone","type":"text"}],"type":"rich_text_preformatted"}],"type":"rich_text"}]},{"client_msg_id":"25c04616-4ce9-4bcb-9ed0-e8708b0faeb7","type":"message","text":"これ実行して 685 で落ちた。","user":"U03C6TEAZ","ts":"1583994269.309800","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"6Em","elements":[{"elements":[{"text":"これ実行して 685 で落ちた。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"10ceaf45-a9b5-464f-b214-5dc991a785f9","type":"message","text":"```./foo.sh: 5 行: 22162 Segmentation fault      (コアダンプ) ./helloworld```","user":"U03C6TEAZ","ts":"1583994281.310000","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"pk5","elements":[{"elements":[{"text":"./foo.sh: 5 行: 22162 Segmentation fault      (コアダンプ) ./helloworld","type":"text"}],"type":"rich_text_preformatted"}],"type":"rich_text"}]},{"client_msg_id":"9d59ddd4-9134-4cab-babd-9e3eedd15590","type":"message","text":"OS 違うけど go1.13 だと 99MB で落ちた。","user":"U03C6TEAZ","ts":"1583994480.310600","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"XyWg","elements":[{"elements":[{"text":"OS 違うけど go1.13 だと 99MB で落ちた。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"2960a60f-21a0-4094-9c88-19379076054d","type":"message","text":"mem_linux.goのmmapとmunmapを呼び出しているところにログをいれた。これは1.13.8の結果。","user":"U06BRP8VD","ts":"1583994536.310700","blocks":[{"block_id":"q1s2T","elements":[{"elements":[{"text":"mem_linux.goのmmapとmunmapを呼び出しているところにログをいれた。これは1.13.8の結果。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}],"files":[{"id":"FVB6RRU6B","created":1583994535,"timestamp":1583994535,"name":"Untitled","title":"Untitled","mimetype":"text/plain","filetype":"text","pretty_type":"Plain Text","user":"U06BRP8VD","editable":true,"size":166,"mode":"snippet","is_external":false,"external_type":"","is_public":true,"public_url_shared":false,"display_as_bot":false,"username":"","url_private":"https://files.slack.com/files-pri/T03C4RC8V-FVB6RRU6B/untitled","url_private_download":"https://files.slack.com/files-pri/T03C4RC8V-FVB6RRU6B/download/untitled","permalink":"https://vim-jp.slack.com/files/U06BRP8VD/FVB6RRU6B/untitled","permalink_public":"https://slack-files.com/T03C4RC8V-FVB6RRU6B-5e434a4c27","edit_link":"https://vim-jp.slack.com/files/U06BRP8VD/FVB6RRU6B/untitled/edit","is_starred":false,"has_rich_preview":false}],"upload":true},{"client_msg_id":"0dc39cab-4c4f-4c3e-bc6f-6850458ec0eb","type":"message","text":"こっちは1.14","user":"U06BRP8VD","ts":"1583994554.311000","blocks":[{"block_id":"i04v=","elements":[{"elements":[{"text":"こっちは1.14","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}],"files":[{"id":"FUWH15X6E","created":1583994552,"timestamp":1583994552,"name":"Untitled","title":"Untitled","mimetype":"text/plain","filetype":"text","pretty_type":"Plain Text","user":"U06BRP8VD","editable":true,"size":380,"mode":"snippet","is_external":false,"external_type":"","is_public":true,"public_url_shared":false,"display_as_bot":false,"username":"","url_private":"https://files.slack.com/files-pri/T03C4RC8V-FUWH15X6E/untitled","url_private_download":"https://files.slack.com/files-pri/T03C4RC8V-FUWH15X6E/download/untitled","permalink":"https://vim-jp.slack.com/files/U06BRP8VD/FUWH15X6E/untitled","permalink_public":"https://slack-files.com/T03C4RC8V-FUWH15X6E-3553bd2369","edit_link":"https://vim-jp.slack.com/files/U06BRP8VD/FUWH15X6E/untitled/edit","is_starred":false,"has_rich_preview":false}],"upload":true},{"client_msg_id":"3cfeeb4b-a337-4326-ad86-5f68dcb82987","type":"message","text":"増えてますねえ","user":"UAZ33BKV2","ts":"1583994606.311700","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"MKF","elements":[{"elements":[{"text":"増えてますねえ","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"8a217c07-8f95-46e5-8743-2b66f54349f1","type":"message","text":"`sysReserve:  536870912` が特に怪しいね。","user":"U06BRP8VD","ts":"1583994607.311800","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"jGg","elements":[{"elements":[{"style":{"code":true},"text":"sysReserve:  536870912","type":"text"},{"text":" が特に怪しいね。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"26867109-7692-4169-821b-e22016784e2d","type":"message","text":"`sysReserve:  67108864` が2度走ってるのもへん","user":"U06BRP8VD","ts":"1583994628.312100","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"tZa","elements":[{"elements":[{"style":{"code":true},"text":"sysReserve:  67108864","type":"text"},{"text":" が2度走ってるのもへん","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"5c03a1e0-3830-4054-a882-1358b82be5f3","type":"message","text":"```    mp.fastrand[0] = 1597334677 * uint32(mp.id)\n      mp.fastrand[1] = uint32(cputicks())\n      if mp.fastrand[0]|mp.fastrand[1] == 0 {\n          mp.fastrand[1] = 1\n      }\n\n      mpreinit(mp)\n      if mp.gsignal != nil {\n          mp.gsignal.stackguard1 = mp.gsignal.stack.lo + _StackGuard\n      }```\nproc.go のここだな。","user":"U03C6TEAZ","ts":"1583994668.312400","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"lZd","elements":[{"elements":[{"text":"    mp.fastrand[0] = 1597334677 * uint32(mp.id)\n      mp.fastrand[1] = uint32(cputicks())\n      if mp.fastrand[0]|mp.fastrand[1] == 0 {\n          mp.fastrand[1] = 1\n      }\n\n      mpreinit(mp)\n      if mp.gsignal != nil {\n          mp.gsignal.stackguard1 = mp.gsignal.stack.lo + _StackGuard\n      }","type":"text"}],"type":"rich_text_preformatted"},{"elements":[{"text":"proc.go のここだな。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"6ded860a-304b-4e55-b01f-8e5872dd4ed0","type":"message","text":"mpreinit","user":"U03C6TEAZ","ts":"1583994673.312600","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"AnF6","elements":[{"elements":[{"text":"mpreinit","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"a52def64-5ecc-47e6-a240-f5e864754102","type":"message","text":"で渡してる fastrand の値、go1.14 だとこんな計算してる","user":"U03C6TEAZ","ts":"1583994705.313000","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"0G4","elements":[{"elements":[{"text":"で渡してる fastrand の値、go1.14 だとこんな計算してる","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"29540c64-7edf-40a1-9e67-2469734f4039","type":"message","text":"```        mp.fastrand[0] = uint32(int64Hash(uint64(mp.id), fastrandseed))\n        mp.fastrand[1] = uint32(int64Hash(uint64(cputicks()), ^fastrandseed))\n        if mp.fastrand[0]|mp.fastrand[1] == 0 {\n                mp.fastrand[1] = 1\n        }\n\n        mpreinit(mp)\n        if mp.gsignal != nil {\n                mp.gsignal.stackguard1 = mp.gsignal.stack.lo + _StackGuard\n        }```","user":"U03C6TEAZ","ts":"1583994707.313200","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"C=pn","elements":[{"elements":[{"text":"        mp.fastrand[0] = uint32(int64Hash(uint64(mp.id), fastrandseed))\n        mp.fastrand[1] = uint32(int64Hash(uint64(cputicks()), ^fastrandseed))\n        if mp.fastrand[0]|mp.fastrand[1] == 0 {\n                mp.fastrand[1] = 1\n        }\n\n        mpreinit(mp)\n        if mp.gsignal != nil {\n                mp.gsignal.stackguard1 = mp.gsignal.stack.lo + _StackGuard\n        }","type":"text"}],"type":"rich_text_preformatted"}],"type":"rich_text"}]},{"client_msg_id":"c88b8d23-a7e1-4661-803f-806d6c55ed48","type":"message","text":"fastrandseed の初期値は\n```s := (*[unsafe.Sizeof(fastrandseed)]byte)(unsafe.Pointer(&amp;fastrandseed))[:]\ngetRandomData(s)```","user":"U03C6TEAZ","ts":"1583994731.313500","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"Osij","elements":[{"elements":[{"text":"fastrandseed の初期値は\n","type":"text"}],"type":"rich_text_section"},{"elements":[{"text":"s := (*[unsafe.Sizeof(fastrandseed)]byte)(unsafe.Pointer(&fastrandseed))[:]\ngetRandomData(s)","type":"text"}],"type":"rich_text_preformatted"}],"type":"rich_text"}],"edited":{"user":"U03C6TEAZ","ts":"1583994755.000000"}},{"client_msg_id":"73735387-d4b7-458d-82d6-ebbcac5f1ede","type":"message","text":"うむ。ほぼ sysReserve の呼び出しの増加分がVSZ要求の増加分になってる感じ。","user":"U06BRP8VD","ts":"1583994930.314200","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"liw","elements":[{"elements":[{"text":"うむ。ほぼ sysReserve の呼び出しの増加分がVSZ要求の増加分になってる感じ。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"3ddbf174-41ca-44e7-9722-780773a95752","type":"message","text":"あ、僕の見てるの違うわ。","user":"U03C6TEAZ","ts":"1583994959.314400","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"Y9c","elements":[{"elements":[{"text":"あ、僕の見てるの違うわ。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"73a96ac9-f96d-4288-87ad-7970056a5774","type":"message","text":"sysReserve で取られた後の次の alloc で落ちてるところだ。","user":"U03C6TEAZ","ts":"1583994962.314600","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"Ehgb","elements":[{"elements":[{"text":"sysReserve で取られた後の次の alloc で落ちてるところだ。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}],"edited":{"user":"U03C6TEAZ","ts":"1583994981.000000"}},{"client_msg_id":"9d3496e8-c7aa-404d-bc6d-facf1f8e9d0d","type":"message","text":"sysReserveAligned の windows のとこひどくないかw\n```func sysReserveAligned(v unsafe.Pointer, size, align uintptr) (unsafe.Pointer, uintptr) {\n    // Since the alignment is rather large in uses of this\n    // function, we're not likely to get it by chance, so we ask\n    // for a larger region and remove the parts we don't need.\n    retries := 0\nretry:\n    p := uintptr(sysReserve(v, size+align))\n    switch {\n    case p == 0:\n        return nil, 0\n    case p&amp;(align-1) == 0:\n        // We got lucky and got an aligned region, so we can\n        // use the whole thing.\n        return unsafe.Pointer(p), size + align\n    case GOOS == \"windows\":\n        // On Windows we can't release pieces of a\n        // reservation, so we release the whole thing and\n        // re-reserve the aligned sub-region. This may race,\n        // so we may have to try again.\n        sysFree(unsafe.Pointer(p), size+align, nil)\n        p = round(p, align)\n        p2 := sysReserve(unsafe.Pointer(p), size)```","user":"U03C6TEAZ","ts":"1583995081.315100","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"Nbm","elements":[{"elements":[{"text":"sysReserveAligned の windows のとこひどくないかw\n","type":"text"}],"type":"rich_text_section"},{"elements":[{"text":"func sysReserveAligned(v unsafe.Pointer, size, align uintptr) (unsafe.Pointer, uintptr) {\n    // Since the alignment is rather large in uses of this\n    // function, we're not likely to get it by chance, so we ask\n    // for a larger region and remove the parts we don't need.\n    retries := 0\nretry:\n    p := uintptr(sysReserve(v, size+align))\n    switch {\n    case p == 0:\n        return nil, 0\n    case p&(align-1) == 0:\n        // We got lucky and got an aligned region, so we can\n        // use the whole thing.\n        return unsafe.Pointer(p), size + align\n    case GOOS == \"windows\":\n        // On Windows we can't release pieces of a\n        // reservation, so we release the whole thing and\n        // re-reserve the aligned sub-region. This may race,\n        // so we may have to try again.\n        sysFree(unsafe.Pointer(p), size+align, nil)\n        p = round(p, align)\n        p2 := sysReserve(unsafe.Pointer(p), size)","type":"text"}],"type":"rich_text_preformatted"}],"type":"rich_text"}],"reactions":[{"name":"grin","users":["U06BRP8VD"],"count":1}]},{"client_msg_id":"0ef94c08-35b3-4b61-a49c-3403ca8965a3","type":"message","text":"できないなら仕方ない()","user":"UK7DT8URY","ts":"1583995173.315400","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"3BV0","elements":[{"elements":[{"text":"できないなら仕方ない()","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"d3a429a5-a4a6-412c-af54-4fab7402e7f3","type":"message","text":"なら最初の strReserve もやめればいいのに...","user":"U03C6TEAZ","ts":"1583995204.315700","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"eOcx+","elements":[{"elements":[{"text":"なら最初の strReserve もやめればいいのに...","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"f4d4cdc7-6a7f-4d5c-a389-2c31f7c2a1cb","type":"message","text":"sysReserveのコンベンションがよくわかんないんですよね。","user":"U06BRP8VD","ts":"1583995227.316100","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"ffZJi","elements":[{"elements":[{"text":"sysReserveのコンベンションがよくわかんないんですよね。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"704117e0-b256-4ac8-8d1a-f019b6605a56","type":"message","text":"むかし(1.13)はsysReserveしてからsysMapなのかなって感じだったんだけど、いまはようわからない","user":"U06BRP8VD","ts":"1583995251.316700","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"ICYX","elements":[{"elements":[{"text":"むかし(1.13)はsysReserveしてからsysMapなのかなって感じだったんだけど、いまはようわからない","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"ffb3c79e-dd24-4f25-aacf-e9c17e88cc0f","type":"message","text":"pageAlloc.sysInitがめっちゃreserveしてるってことだけはわかった。","user":"U06BRP8VD","ts":"1583995826.317100","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"C+u","elements":[{"elements":[{"text":"pageAlloc.sysInitがめっちゃreserveしてるってことだけはわかった。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"ea0da11f-b488-4ec1-9557-2c227fbfd618","type":"message","text":"<https://github.com/golang/go/issues/28081#issue-367959439>","user":"U03C6TEAZ","ts":"1583995829.317300","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","attachments":[{"service_name":"GitHub","title":"runtime: arena mapping creates large core files and bad mlockall behavior · Issue #28081 · golang/go","title_link":"https://github.com/golang/go/issues/28081#issue-367959439","text":"package main var p *int func main() { *p = 0 } Run with $ ulimit -c unlimited $ GOTRACEBACK=crash go run test.go $ ls -l core Go 1.11 and tip generate a ~100MB core. Go 1.10 and earlier only genera...","fallback":"GitHub: runtime: arena mapping creates large core files and bad mlockall behavior · Issue #28081 · golang/go","thumb_url":"https://avatars3.githubusercontent.com/u/4314092?s=400&v=4","from_url":"https://github.com/golang/go/issues/28081#issue-367959439","thumb_width":400,"thumb_height":400,"service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","id":1,"original_url":"https://github.com/golang/go/issues/28081#issue-367959439"}],"blocks":[{"block_id":"YkO","elements":[{"elements":[{"type":"link","url":"https://github.com/golang/go/issues/28081#issue-367959439"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"b0ebcaa2-368d-4407-a6b6-e91d310e1d79","type":"message","text":"ここで 100mb って言ってるからだいたい同じね。","user":"U03C6TEAZ","ts":"1583995840.317800","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"cD+z","elements":[{"elements":[{"text":"ここで 100mb って言ってるからだいたい同じね。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"322ac589-713b-450f-a21e-3ced5fc395c4","type":"message","text":"GOTRACEBACK=crashってなに?","user":"U06BRP8VD","ts":"1583995875.318100","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"xuX6n","elements":[{"elements":[{"text":"GOTRACEBACK=crashってなに?","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"d4694230-a10a-41ed-ac73-05e9d83c9655","type":"message","text":"core 作るやつ","user":"U03C6TEAZ","ts":"1583995936.318300","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"7i3xd","elements":[{"elements":[{"text":"core 作るやつ","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"1ebd4de2-a327-4df8-8631-b258fd20559c","type":"message","text":"アリーナが最小で64MB+35MBで持っていくからまぁそれはアローケーション速度考えたらしかたないといえなくもない","user":"U06BRP8VD","ts":"1583996080.319400","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"wIpsf","elements":[{"elements":[{"text":"アリーナが最小で64MB+35MBで持っていくからまぁそれはアローケーション速度考えたらしかたないといえなくもない","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"77a26644-7404-4e77-bd8a-89e7f288eb4a","type":"message","text":"1.14 たしかページアロケータ書き換えたみたいなコミットは見た事ある。","user":"U03C6TEAZ","ts":"1583997011.319900","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"3U7vp","elements":[{"elements":[{"text":"1.14 たしかページアロケータ書き換えたみたいなコミットは見た事ある。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"07c93fc8-cca0-4944-bdcf-995fb5694f9e","type":"message","text":"<https://github.com/golang/go/commit/14849f0fa57c67996bb00bd42bb14cef9f4e9a1e#diff-859dbbff1e58a5ae26b39484219d4791>","user":"U03C6TEAZ","ts":"1583997069.320100","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","attachments":[{"service_name":"GitHub","title":"runtime: add new page allocator constants and description · golang/go@14849f0","title_link":"https://github.com/golang/go/commit/14849f0fa57c67996bb00bd42bb14cef9f4e9a1e#diff-859dbbff1e58a5ae26b39484219d4791","text":"This change is the first of a series of changes which replace the current page allocator (which is based on the contents of mgclarge.go and some of mheap.go) with one based on free/used bitmaps. I...","fallback":"GitHub: runtime: add new page allocator constants and description · golang/go@14849f0","thumb_url":"https://avatars2.githubusercontent.com/u/1248668?s=200&v=4","from_url":"https://github.com/golang/go/commit/14849f0fa57c67996bb00bd42bb14cef9f4e9a1e#diff-859dbbff1e58a5ae26b39484219d4791","thumb_width":200,"thumb_height":200,"service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","id":1,"original_url":"https://github.com/golang/go/commit/14849f0fa57c67996bb00bd42bb14cef9f4e9a1e#diff-859dbbff1e58a5ae26b39484219d4791"}],"blocks":[{"block_id":"LTn","elements":[{"elements":[{"type":"link","url":"https://github.com/golang/go/commit/14849f0fa57c67996bb00bd42bb14cef9f4e9a1e#diff-859dbbff1e58a5ae26b39484219d4791"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"761f1841-38de-4af6-93f2-be409dd1092a","type":"message","text":"mpagealloc_64bits.go の pageAlloc.sysInit で複数のサイズをアロケートしてる…","user":"U06BRP8VD","ts":"1583997408.321000","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"aHIR","elements":[{"elements":[{"text":"mpagealloc_64bits.go の pageAlloc.sysInit で複数のサイズをアロケートしてる…","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"47e9cfea-57ee-4edc-9f3f-b69659b6718a","type":"message","text":"いやせいかくにはsysReserveか","user":"U06BRP8VD","ts":"1583997415.321200","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"b+8","elements":[{"elements":[{"text":"いやせいかくにはsysReserveか","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"59fa18db-fe59-46a9-8ab5-38609c70dca8","type":"message","text":"さてさて…page allocatorが600MB確保する必要性について、考えなきゃな…","user":"U06BRP8VD","ts":"1583998127.322200","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"UaP","elements":[{"elements":[{"text":"さてさて…page allocatorが600MB確保する必要性について、考えなきゃな…","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"47f7ddf8-34ad-458d-bc15-3db5d7bd4d92","type":"message","text":"tip で試す為にビルド中","user":"U03C6TEAZ","ts":"1584000327.322600","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"nlm","elements":[{"elements":[{"text":"tip で試す為にビルド中","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"5f6b71f5-22c1-46b5-ae5d-dd1b99e6ec78","type":"message","text":"ちなみに 600 が困るのは cloud ?","user":"U03C6TEAZ","ts":"1584000369.323200","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"8Uy","elements":[{"elements":[{"text":"ちなみに 600 が困るのは cloud ?","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"a1153134-a6ae-4fc3-a5c8-b03a87894e46","type":"message","text":"まずはdockerです。利用するメモリを厳密に制限したい。そのうえで制限を超えるときはダンプを吐いて止まってほしい。\n<https://www.kaoriya.net/blog/2020/01/18/golang-on-docker-oom/>\n\ngo製のプログラムはVSZでメモリ枯渇を見てるんで ulimit -v で制限せざるを得ない。にもかかわらず初期状態でめちゃくちゃ大きなVSZを確保しちゃうんで、制限の意味が希薄になってしまう。","user":"U06BRP8VD","ts":"1584000505.325100","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","attachments":[{"service_name":"kaoriya.net","title":"golangとDockerとOOM — KaoriYa","title_link":"https://www.kaoriya.net/blog/2020/01/18/golang-on-docker-oom/","text":"golangで書いたプログラムをDockerで動かしOOMが発生した際になるべく情報を残して殺される方法を紹介します。","fallback":"golangとDockerとOOM — KaoriYa","from_url":"https://www.kaoriya.net/blog/2020/01/18/golang-on-docker-oom/","service_icon":"https://www.kaoriya.net/favicon.ico","id":1,"original_url":"https://www.kaoriya.net/blog/2020/01/18/golang-on-docker-oom/"}],"blocks":[{"block_id":"iHP4","elements":[{"elements":[{"text":"まずはdockerです。利用するメモリを厳密に制限したい。そのうえで制限を超えるときはダンプを吐いて止まってほしい。\n","type":"text"},{"type":"link","url":"https://www.kaoriya.net/blog/2020/01/18/golang-on-docker-oom/"},{"text":"\n\ngo製のプログラムはVSZでメモリ枯渇を見てるんで ulimit -v で制限せざるを得ない。にもかかわらず初期状態でめちゃくちゃ大きなVSZを確保しちゃうんで、制限の意味が希薄になってしまう。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}],"reactions":[{"name":"naruhodo","users":["U03C6TEAZ","UK7DT8URY"],"count":2}],"edited":{"user":"U06BRP8VD","ts":"1584000533.000000"}},{"client_msg_id":"1b110440-e9ec-48a3-8e96-fc535a43ad60","type":"message","text":"ちょっと大きなプログラムだと起動に1GB以上のメモリが必要になって(実際に使う物理メモリは200MBくらい)、オーケストレーションツールとかでいろいろ合わせるとメモリ見積もりがまったく機能しない状態になっちゃうんですね。","user":"U06BRP8VD","ts":"1584000613.326900","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"4Bv","elements":[{"elements":[{"text":"ちょっと大きなプログラムだと起動に1GB以上のメモリが必要になって(実際に使う物理メモリは200MBくらい)、オーケストレーションツールとかでいろいろ合わせるとメモリ見積もりがまったく機能しない状態になっちゃうんですね。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}],"reactions":[{"name":"totemoturai","users":["U03C6TEAZ"],"count":1}],"edited":{"user":"U06BRP8VD","ts":"1584000631.000000"}},{"client_msg_id":"bf4a35d5-2e34-4236-b61f-3555435ff188","type":"message","text":"tip\n```685\nSegmentation fault (core dumped)```","user":"U03C6TEAZ","ts":"1584000690.327200","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"GJxc","elements":[{"elements":[{"text":"tip\n","type":"text"}],"type":"rich_text_section"},{"elements":[{"text":"685\nSegmentation fault (core dumped)","type":"text"}],"type":"rich_text_preformatted"}],"type":"rich_text"}]},{"client_msg_id":"5de82de7-fc73-4475-976d-e3c0d69700de","type":"message","text":"そうすね。go だとツール文化なので3個も4個も同時に起動するとそれだけで数GB必要になりますね。","user":"U03C6TEAZ","ts":"1584000752.328000","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"Wf4","elements":[{"elements":[{"text":"そうすね。go だとツール文化なので3個も4個も同時に起動するとそれだけで数GB必要になりますね。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"4a830a59-be6b-4602-9459-1bd54dad334f","type":"message","text":"G社の様にメモリが蛇口から流れ出す水の様に見えるなら別だけど。","user":"U03C6TEAZ","ts":"1584000807.328600","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"CJlCC","elements":[{"elements":[{"text":"G社の様にメモリが蛇口から流れ出す水の様に見えるなら別だけど。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"aa50611b-60c3-4457-8b61-68d059f7d10b","type":"message","text":"```GODEBUG=allocfreetrace=1```","user":"U03C6TEAZ","ts":"1584000930.329000","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"hFWxe","elements":[{"elements":[{"text":"GODEBUG=allocfreetrace=1","type":"text"}],"type":"rich_text_preformatted"}],"type":"rich_text"}]},{"client_msg_id":"1cff30a5-7209-4c93-9223-bbd691375d89","type":"message","text":"これ付けて起動すれば場所とサイズは分かるはず。","user":"U03C6TEAZ","ts":"1584000940.329400","thread_ts":"1584000940.329400","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"dFQ","elements":[{"elements":[{"text":"これ付けて起動すれば場所とサイズは分かるはず。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"81e6d437-7f54-402d-9f21-f96887a92f46","type":"message","text":"<https://qiita.com/mattn/items/e613c1f8575580f98194>","user":"U03C6TEAZ","ts":"1584000946.329700","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","attachments":[{"service_name":"Qiita","title":"Go ランタイムのデバッグをサポートする環境変数 - Qiita","title_link":"https://qiita.com/mattn/items/e613c1f8575580f98194","text":"# はじめに Go はシンプルな構文ながら複雑な処理を行えるプログラミング言語です。エラーも自らがハンドリングするスタイルなので割とバグが入り込みにくいのが特徴です。しかし時には Go 本体のソースを見ないと動きが確認できない事も...","fallback":"Qiita: Go ランタイムのデバッグをサポートする環境変数 - Qiita","from_url":"https://qiita.com/mattn/items/e613c1f8575580f98194","service_icon":"https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png","id":1,"original_url":"https://qiita.com/mattn/items/e613c1f8575580f98194"}],"blocks":[{"block_id":"gPMQ","elements":[{"elements":[{"type":"link","url":"https://qiita.com/mattn/items/e613c1f8575580f98194"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"4892de42-53fc-4871-a2f3-22d690d4f786","type":"message","text":"こう見ると、Javaの引数でメモリの確保量をコントロールできる仕組みはわりと合理的なんだな…… (アレはVMだから色々違うけど)","user":"UK7DT8URY","ts":"1584000974.330500","thread_ts":"1584000974.330500","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"wtUa/","elements":[{"elements":[{"text":"こう見ると、Javaの引数でメモリの確保量をコントロールできる仕組みはわりと合理的なんだな…… (アレはVMだから色々違うけど)","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}],"reactions":[{"name":"sorena","users":["U06BRP8VD"],"count":1}]},{"client_msg_id":"df6fbd56-7672-4132-bae9-6f35ac468790","type":"message","text":"「落ちたのはお前が引数を指定しなかったからだ」という言い訳にできて便利。","user":"U03C6TEAZ","ts":"1584001026.331000","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"WmmfG","elements":[{"elements":[{"text":"「落ちたのはお前が引数を指定しなかったからだ」という言い訳にできて便利。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}],"reactions":[{"name":"coffeeing","users":["UK7DT8URY"],"count":1}]},{"client_msg_id":"e2d05eb1-1574-455c-aa46-68d5ce64d6b8","type":"message","text":"たぶんこれ機能しないんじゃないかな。あたらしいページアロケーターが対応していない&amp;起動しただけで512+64+8+1MBもっていくので","user":"U06BRP8VD","ts":"1584001065.331100","thread_ts":"1584000940.329400","parent_user_id":"U03C6TEAZ","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"JWANQ","elements":[{"elements":[{"text":"たぶんこれ機能しないんじゃないかな。あたらしいページアロケーターが対応していない&起動しただけで512+64+8+1MBもっていくので","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"51096e0c-0c9a-4fbc-9ce4-11c8fb0a6442","type":"message","text":"そもそもページアロケーターが確保するこのメモリ、Goのmemstatに記録されなさそう。","user":"U06BRP8VD","ts":"1584001132.331400","thread_ts":"1584000940.329400","parent_user_id":"U03C6TEAZ","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"fGf","elements":[{"elements":[{"text":"そもそもページアロケーターが確保するこのメモリ、Goのmemstatに記録されなさそう。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"eb9ac942-609c-406f-a6e4-b17a0fc6dd83","type":"message","text":"やっぱでてなさげw","user":"U06BRP8VD","ts":"1584001178.331600","thread_ts":"1584000940.329400","parent_user_id":"U03C6TEAZ","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"1Fltn","elements":[{"elements":[{"text":"やっぱでてなさげw","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"e9d1e02a-a9ed-40d2-ad09-db89156f5e4a","type":"message","text":"つーかね、新しいpageallocatorがページ管理のために使うメモリに関しては振る舞いを制御したりモニタする機構が何一つないのよ。","user":"U06BRP8VD","ts":"1584001263.332500","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"n0blH","elements":[{"elements":[{"text":"つーかね、新しいpageallocatorがページ管理のために使うメモリに関しては振る舞いを制御したりモニタする機構が何一つないのよ。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}],"edited":{"user":"U06BRP8VD","ts":"1584001287.000000"}},{"client_msg_id":"cc4fbd1d-e627-425c-a1b0-b25676b77d2f","type":"message","text":"古いページアロケータ ←→ 新しいページアロケータ\n<https://twitter.com/NicoRiveros22/status/1237922586274729984>","user":"U03C6TEAZ","ts":"1584001510.333600","thread_ts":"1584001510.333600","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","attachments":[{"service_name":"twitter","author_icon":"https://pbs.twimg.com/profile_images/1231419387330121728/iWGqFmny_normal.jpg","author_name":"Nicolàs Riveros.","author_subname":"@NicoRiveros22","text":"Expulsado Adebayor en #Olimpia\n#CopaLibertadores2020","fallback":"<https://twitter.com/NicoRiveros22|@NicoRiveros22>: Expulsado Adebayor en #Olimpia\n#CopaLibertadores2020 <https://pbs.twimg.com/ext_tw_video_thumb/1237922532055007238/pu/img/W8hG-pJ_hGCyml44.jpg>","thumb_url":"https://pbs.twimg.com/ext_tw_video_thumb/1237922532055007238/pu/img/W8hG-pJ_hGCyml44.jpg","from_url":"https://twitter.com/NicoRiveros22/status/1237922586274729984","thumb_width":1200,"thumb_height":675,"id":1,"original_url":"https://twitter.com/NicoRiveros22/status/1237922586274729984","video_html":"<video controls poster=\"https://pbs.twimg.com/ext_tw_video_thumb/1237922532055007238/pu/img/W8hG-pJ_hGCyml44.jpg\" width=\"1200\" height=\"675\"><source type=\"video/mp4\" src=\"https://video.twimg.com/ext_tw_video/1237922532055007238/pu/vid/1280x720/KJeBOkvO1p_Kbm90.mp4?tag=10\"></video>","video_html_width":1200,"video_html_height":675,"footer":"Twitter","footer_icon":"https://a.slack-edge.com/80588/img/services/twitter_pixel_snapped_32.png"}],"blocks":[{"block_id":"lhn","elements":[{"elements":[{"text":"古いページアロケータ ←→ 新しいページアロケータ\n","type":"text"},{"type":"link","url":"https://twitter.com/NicoRiveros22/status/1237922586274729984"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"8e38aa06-cfaf-47e7-b650-642fb3193b4a","type":"message","subtype":"thread_broadcast","text":"もともとのgoの思想から考えると、OSの機能であるulimit -vで良いじゃんって感じに見えますね。ところがアロケーターを現実的な問題を解決するように修正していくにつれ、そこと乖離してしまった。","user":"U06BRP8VD","ts":"1584001519.333800","thread_ts":"1584000974.330500","blocks":[{"block_id":"1H8f","elements":[{"elements":[{"text":"もともとのgoの思想から考えると、OSの機能であるulimit -vで良いじゃんって感じに見えますね。ところがアロケーターを現実的な問題を解決するように修正していくにつれ、そこと乖離してしまった。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}],"reactions":[{"name":"tashikani","users":["UAZ33BKV2"],"count":1}],"root":{"client_msg_id":"4892de42-53fc-4871-a2f3-22d690d4f786","type":"message","text":"こう見ると、Javaの引数でメモリの確保量をコントロールできる仕組みはわりと合理的なんだな…… (アレはVMだから色々違うけど)","user":"UK7DT8URY","ts":"1584000974.330500","thread_ts":"1584000974.330500","team":"T03C4RC8V","blocks":[{"block_id":"wtUa/","elements":[{"elements":[{"text":"こう見ると、Javaの引数でメモリの確保量をコントロールできる仕組みはわりと合理的なんだな…… (アレはVMだから色々違うけど)","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]}},{"client_msg_id":"3b1d3a3f-9756-4fe1-93d0-d0865b08befa","type":"message","text":"こんなん新しいアロケータ一発退場じゃんwww","user":"U06BRP8VD","ts":"1584001550.334300","thread_ts":"1584001510.333600","parent_user_id":"U03C6TEAZ","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"rv1","elements":[{"elements":[{"text":"こんなん新しいアロケータ一発退場じゃんwww","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"605ecbb9-5cb2-4464-906d-fb2ba22618cc","type":"message","text":"逆に言うとアレか、javaのXmx相当のオプションが増えてても良いのか。Goに","user":"U06BRP8VD","ts":"1584001604.335400","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"9FdA","elements":[{"elements":[{"text":"逆に言うとアレか、javaのXmx相当のオプションが増えてても良いのか。Goに","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"70ba1c83-b597-4048-8e6a-17178424467f","type":"message","text":"ただ現状まだバガッと取ってそうな個所が特定できてないんですよねー。","user":"U03C6TEAZ","ts":"1584001720.336000","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"s/D0G","elements":[{"elements":[{"text":"ただ現状まだバガッと取ってそうな個所が特定できてないんですよねー。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"b0dcd61e-4a96-4b68-aec3-481af99fafc1","type":"message","text":"どっちかっていうと new allocator の仕組み上、そうなっちゃってる(複数回呼ばれて)みたいな動き。","user":"U03C6TEAZ","ts":"1584001750.336800","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"PBmqL","elements":[{"elements":[{"text":"どっちかっていうと new allocator の仕組み上、そうなっちゃってる(複数回呼ばれて)みたいな動き。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"6db6ccfc-f84b-4f44-98fb-564eebeb7f4c","type":"message","text":"ガバッと取る量を変えてるならどこかにコメント残っててもおかしくないけどそれもない。","user":"U03C6TEAZ","ts":"1584001787.337300","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"Fu/k","elements":[{"elements":[{"text":"ガバッと取る量を変えてるならどこかにコメント残っててもおかしくないけどそれもない。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"4a742b73-fcbd-4439-8982-d0e5cbedbfb2","type":"message","text":"おもってたより、ガバッととっちゃった(想定しきれてなかった)のかな...ちょっと怖いが","user":"UAZ33BKV2","ts":"1584001827.337900","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"B4NV","elements":[{"elements":[{"text":"おもってたより、ガバッととっちゃった(想定しきれてなかった)のかな...ちょっと怖いが","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"type":"message","text":"ここで (512 + 64 + 8 + 1 + α)MB ごっつりとってます。","user":"U06BRP8VD","ts":"1584002090.338500","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","attachments":[{"author_icon":"https://secure.gravatar.com/avatar/4b5a6f711a4e22e617b74058239ade53.jpg?s=48&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0007-48.png","author_name":"KoRoN","author_subname":"KoRoN","text":"mpagealloc_64bits.go の pageAlloc.sysInit で複数のサイズをアロケートしてる…","fallback":"[March 12th, 2020 4:16 PM] koron: mpagealloc_64bits.go の pageAlloc.sysInit で複数のサイズをアロケートしてる…","from_url":"https://vim-jp.slack.com/archives/CGABGC8LA/p1583997408321000","id":0,"footer":"Posted in #golang"}],"blocks":[{"block_id":"/4fz7","elements":[{"elements":[{"text":"ここで (512 + 64 + 8 + 1 + α)MB ごっつりとってます。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"3adaa1c6-d335-4f59-9da8-ed93501d18c8","type":"message","text":"これはradix tree 構成するために仕方なくという感じになっちゃってる。","user":"U06BRP8VD","ts":"1584002119.339000","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"JB6V","elements":[{"elements":[{"text":"これはradix tree 構成するために仕方なくという感じになっちゃってる。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"1b05178b-1cbc-43b9-bc44-57a449540c74","type":"message","text":"まぁ対応するページを確保しないとpage in しない使い方なので物理メモリ的にはダイジョブなんですけど…","user":"U06BRP8VD","ts":"1584002152.339800","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"N52qA","elements":[{"elements":[{"text":"まぁ対応するページを確保しないとpage in しない使い方なので物理メモリ的にはダイジョブなんですけど…","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"134baa96-1d66-47e1-a066-17e303412b82","type":"message","text":"あれ、じゃあなぜあのテストコードで...ああ、プロセスに取れる根本を制限したからこけるか見えたと...","user":"UAZ33BKV2","ts":"1584002241.340700","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"s6OS","elements":[{"elements":[{"text":"あれ、じゃあなぜあのテストコードで...ああ、プロセスに取れる根本を制限したからこけるか見えたと...","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"fd7182f7-538f-493a-9114-be4ad9927bf5","type":"message","text":"VSZで制限するテストだからですね。","user":"U06BRP8VD","ts":"1584002265.341400","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"sfOf","elements":[{"elements":[{"text":"VSZで制限するテストだからですね。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"b54b1e5d-fd7e-4b7c-957e-1c82599ab0d1","type":"message","text":"仮想メモリは書き込まない限り0フィルされた共用ページにマップされて、物理メモリを消費しないんですよ。","user":"U06BRP8VD","ts":"1584002323.342600","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"xzKS","elements":[{"elements":[{"text":"仮想メモリは書き込まない限り0フィルされた共用ページにマップされて、物理メモリを消費しないんですよ。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}],"reactions":[{"name":"otz","users":["UAZ33BKV2"],"count":1}]},{"client_msg_id":"168a8b0c-d53c-469f-8de9-bb7a28351746","type":"message","text":"あ、そこらはわりと知ってるので...とはいえありがとうございます。","user":"UAZ33BKV2","ts":"1584002402.343100","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"eaz","elements":[{"elements":[{"text":"あ、そこらはわりと知ってるので...とはいえありがとうございます。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}],"reactions":[{"name":"cat-salute","users":["U06BRP8VD"],"count":1},{"name":"cat-dogeza-mike","users":["U06BRP8VD"],"count":1},{"name":"kawaii","users":["U8R597E9H"],"count":1}]},{"client_msg_id":"200f8270-15a5-42e7-9395-6da30b191c73","type":"message","text":"しかしすごい量だな...、いや昨今のプロセス、わりと1GBとか取ることはあるけど","user":"UAZ33BKV2","ts":"1584002437.343900","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"b6Hf","elements":[{"elements":[{"text":"しかしすごい量だな...、いや昨今のプロセス、わりと1GBとか取ることはあるけど","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"23093787-838b-458e-9bda-32ade22fbd27","type":"message","text":"VSZだから基本的には痛くないんですが","user":"U06BRP8VD","ts":"1584002459.344300","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"BXeQ","elements":[{"elements":[{"text":"VSZだから基本的には痛くないんですが","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"c382da17-4e6f-4c4e-9005-fd94c8c96892","type":"message","text":"たぶんOpenBSDでテストがこける(から無効化しちゃった)件とか、このあたりが関係してる気がしてなりません。","user":"U06BRP8VD","ts":"1584002487.345100","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"FaBW7","elements":[{"elements":[{"text":"たぶんOpenBSDでテストがこける(から無効化しちゃった)件とか、このあたりが関係してる気がしてなりません。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"b4852aa2-e9f5-4db6-b8bb-e3389a576680","type":"message","text":"省メモリにしたければ 386 を使えということだったり？","user":"UA4RVLHK7","ts":"1584002501.345400","thread_ts":"1584002501.345400","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"8tbv","elements":[{"elements":[{"text":"省メモリにしたければ 386 を使えということだったり？","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"47c06375-3568-45b3-a82a-ab631ce0161f","type":"message","text":"には見えますねw (コード読む限り)","user":"U03C6TEAZ","ts":"1584002530.345800","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"p3t","elements":[{"elements":[{"text":"には見えますねw (コード読む限り)","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"30794277-8b33-4e48-b51d-e904fbd4cde1","type":"message","text":"<https://github.com/golang/go/commit/cd1b9c1d5a7bb8ea6ebec223ce11e91897584ef4>","user":"U06BRP8VD","ts":"1584002562.346100","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","attachments":[{"service_name":"GitHub","title":"runtime: disable pageAlloc tests on OpenBSD in short mode · golang/go@cd1b9c1","title_link":"https://github.com/golang/go/commit/cd1b9c1d5a7bb8ea6ebec223ce11e91897584ef4","text":"This change disables pageAlloc tests on OpenBSD in short mode because pageAlloc holds relatively large virtual memory reservations and we make two during the pageAlloc tests. The runtime may also b...","fallback":"GitHub: runtime: disable pageAlloc tests on OpenBSD in short mode · golang/go@cd1b9c1","thumb_url":"https://avatars2.githubusercontent.com/u/1248668?s=200&v=4","from_url":"https://github.com/golang/go/commit/cd1b9c1d5a7bb8ea6ebec223ce11e91897584ef4","thumb_width":200,"thumb_height":200,"service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","id":1,"original_url":"https://github.com/golang/go/commit/cd1b9c1d5a7bb8ea6ebec223ce11e91897584ef4"}],"blocks":[{"block_id":"fN8","elements":[{"elements":[{"type":"link","url":"https://github.com/golang/go/commit/cd1b9c1d5a7bb8ea6ebec223ce11e91897584ef4"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"e12fc727-820c-49ca-880b-def55e52fe5c","type":"message","text":"ありゃ32bitだと、レベル数が1つすくないだけでなく、実装も違うのねw","user":"U06BRP8VD","ts":"1584002646.346900","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"UHqVb","elements":[{"elements":[{"text":"ありゃ32bitだと、レベル数が1つすくないだけでなく、実装も違うのねw","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"fdc16a0b-38a1-4ac0-a475-d9a77b0b58c2","type":"message","text":"// See mpagealloc_32bit.go for why darwin/arm64 is excluded here.","user":"UA4RVLHK7","ts":"1584002654.347000","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"g+/","elements":[{"elements":[{"text":"// See mpagealloc_32bit.go for why darwin/arm64 is excluded here.","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"79a1a0f4-1249-4c56-a0fe-5d66bd7358b9","type":"message","text":"```// The number of radix bits for each level.\n//\n// The value of 3 is chosen such that the block of summaries we need to scan at\n// each level fits in 64 bytes (2^3 summaries * 8 bytes per summary), which is\n// close to the L1 cache line width on many systems. Also, a value of 3 fits 4 tree\n// levels perfectly into the 21-bit pallocBits summary field at the root level.\n//\n// The following equation explains how each of the constants relate:\n// summaryL0Bits + (summaryLevels-1)*summaryLevelBits + logPallocChunkBytes = heapAddrBits\n//\n// summaryLevels is an architecture-dependent value defined in mpagealloc_*.go.\nsummaryLevelBits = 3```","user":"U03C6TEAZ","ts":"1584002673.347300","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"RO7S+","elements":[{"elements":[{"text":"// The number of radix bits for each level.\n//\n// The value of 3 is chosen such that the block of summaries we need to scan at\n// each level fits in 64 bytes (2^3 summaries * 8 bytes per summary), which is\n// close to the L1 cache line width on many systems. Also, a value of 3 fits 4 tree\n// levels perfectly into the 21-bit pallocBits summary field at the root level.\n//\n// The following equation explains how each of the constants relate:\n// summaryL0Bits + (summaryLevels-1)*summaryLevelBits + logPallocChunkBytes = heapAddrBits\n//\n// summaryLevels is an architecture-dependent value defined in mpagealloc_*.go.\nsummaryLevelBits = 3","type":"text"}],"type":"rich_text_preformatted"}],"type":"rich_text"}],"edited":{"user":"U03C6TEAZ","ts":"1584002683.000000"}},{"client_msg_id":"52f6ac8d-93fd-48be-bbaf-7a6bc2451a66","type":"message","text":"そそ。なんか実装も違うし計算も違うし。","user":"U03C6TEAZ","ts":"1584002710.348100","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"0kytM","elements":[{"elements":[{"text":"そそ。なんか実装も違うし計算も違うし。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"6130dc66-334b-44be-856a-63a240a703d7","type":"message","text":"まとめてreserveしてる。","user":"U06BRP8VD","ts":"1584002713.348300","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"7Tn","elements":[{"elements":[{"text":"まとめてreserveしてる。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"a36c7306-ee8a-44f1-a5f9-4aeb132b207a","type":"message","text":"で4段分のツリーを切り出してる。","user":"U06BRP8VD","ts":"1584002732.348900","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"Co3h3","elements":[{"elements":[{"text":"で4段分のツリーを切り出してる。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"cbc94b17-10dd-4efb-abc9-22ec961cb6d9","type":"message","text":"メモリ管理の効率はアーキテクチャやサイズで変わるとはいえ、剛毅な... &gt; 違う実装","user":"UAZ33BKV2","ts":"1584002747.349300","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"UoQU","elements":[{"elements":[{"text":"メモリ管理の効率はアーキテクチャやサイズで変わるとはいえ、剛毅な... > 違う実装","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}],"edited":{"user":"UAZ33BKV2","ts":"1584002762.000000"}},{"client_msg_id":"b6d4b649-dd28-4ec9-a30c-a0bcf2f63c18","type":"message","text":"まぁ使えるメモリ2GB超えないなら、32bitで十分やんってのはわからないではないw","user":"U06BRP8VD","ts":"1584002790.350000","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"rqW","elements":[{"elements":[{"text":"まぁ使えるメモリ2GB超えないなら、32bitで十分やんってのはわからないではないw","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"2eeadbfe-5c40-406c-bc85-b33685cd5bb4","type":"message","text":"ただいろいろ遅くはなるんだよな。","user":"U06BRP8VD","ts":"1584002810.350300","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"CUALk","elements":[{"elements":[{"text":"ただいろいろ遅くはなるんだよな。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"8016243f-7ab4-4745-b468-8f7febb06dea","type":"message","text":"あとintをint64で扱っちゃってるところ、全部見直さんと。","user":"U06BRP8VD","ts":"1584002827.350800","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"lob3","elements":[{"elements":[{"text":"あとintをint64で扱っちゃってるところ、全部見直さんと。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"ee481066-93df-4c63-9b0d-99f17aba6a2b","type":"message","text":"あれ、goのintって実装依存のサイズなんですっけ...、昨今の言語として、そこはちょっと微妙に悩む仕様ですね","user":"UAZ33BKV2","ts":"1584002997.351500","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"Jbu","elements":[{"elements":[{"text":"あれ、goのintって実装依存のサイズなんですっけ...、昨今の言語として、そこはちょっと微妙に悩む仕様ですね","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"ac9f39bb-a2d8-46b2-ac52-56e1634c968e","type":"message","text":"32bit だと 6MB で helloworld 起動できたwww","user":"U06BRP8VD","ts":"1584003050.352000","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"x0O","elements":[{"elements":[{"text":"32bit だと 6MB で helloworld 起動できたwww","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}],"reactions":[{"name":"fuita","users":["U9S4G0LJW","UK7DT8URY","U8CC7MDCL"],"count":3}],"edited":{"user":"U06BRP8VD","ts":"1584003065.000000"}},{"client_msg_id":"40d2fa29-f367-4d12-b4d6-9b2b597dd06a","type":"message","text":"ぶw","user":"UAZ33BKV2","ts":"1584003058.352200","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"If7","elements":[{"elements":[{"text":"ぶw","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"f90f8cf9-e89d-48e3-82e7-e48a7665224d","type":"message","text":"つよい子だ","user":"U03C6TEAZ","ts":"1584003062.352400","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"xR8u","elements":[{"elements":[{"text":"つよい子だ","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"76ea31c5-7f47-4b93-986d-8920bbc31091","type":"message","text":"差が激しすぎるw","user":"U9S4G0LJW","ts":"1584003078.352800","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"SQe","elements":[{"elements":[{"text":"差が激しすぎるw","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"daf22291-eafe-48a4-b33a-43f9030f8299","type":"message","text":"家の Raspberry Pi (64bit) で Go 動かす時は絶対に GOARCH=386 するぞと決めた日だった。","user":"U03C6TEAZ","ts":"1584003114.353600","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"atyxr","elements":[{"elements":[{"text":"家の Raspberry Pi (64bit) で Go 動かす時は絶対に GOARCH=386 するぞと決めた日だった。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}],"edited":{"user":"U03C6TEAZ","ts":"1584003273.000000"}},{"client_msg_id":"5604db7e-3b12-4d47-83f9-7be949cb5957","type":"message","text":"てかツール類もそうしたいわ。","user":"U03C6TEAZ","ts":"1584003153.354300","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"mpW1t","elements":[{"elements":[{"text":"てかツール類もそうしたいわ。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"139b95d8-8013-4790-99d5-d9303a48528a","type":"message","text":"gopls もそうしようかなー。","user":"U03C6TEAZ","ts":"1584003159.354600","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"SB6aI","elements":[{"elements":[{"text":"gopls もそうしようかなー。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"3ea6daaa-e7c2-437b-9c22-fdf1ce76ee99","type":"message","text":"ラズパイなのにx86?","user":"U9S4G0LJW","ts":"1584003181.355300","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"TI9wC","elements":[{"elements":[{"text":"ラズパイなのにx86?","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"07600cf0-5ba7-493d-a135-55f70e819697","type":"message","text":"あれか2^32(10*3+2)はMBクラスに対して2^64(10*6+4)だからGBクラスでいけ、というお告げなのかw","user":"UAZ33BKV2","ts":"1584003182.355400","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"nidAh","elements":[{"elements":[{"text":"あれか2^32(10*3+2)はMBクラスに対して2^64(10*6+4)だからGBクラスでいけ、というお告げなのかw","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"46ddfb82-cf94-47f7-826d-d29ba2175748","type":"message","text":"arm64で普段は作ってる?","user":"UAZ33BKV2","ts":"1584003203.355900","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"Gh/io","elements":[{"elements":[{"text":"arm64で普段は作ってる?","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"79bdfa34-9696-4c85-9704-c67f9ee67921","type":"message","text":"そうそう。「4GBメモリを用意できない貧乏人は32bitでも使ってろ」って強いメッセージを感じ取った。","user":"U06BRP8VD","ts":"1584003240.356700","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"ogI6B","elements":[{"elements":[{"text":"そうそう。「4GBメモリを用意できない貧乏人は32bitでも使ってろ」って強いメッセージを感じ取った。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}],"reactions":[{"name":"totemoturai","users":["U9S4G0LJW"],"count":1}]},{"client_msg_id":"20321880-4a3d-4191-af3f-07e146370dc7","type":"message","text":"僕とこだと","user":"U03C6TEAZ","ts":"1584003327.357300","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"=29","elements":[{"elements":[{"text":"僕とこだと","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"d745fa53-a842-40be-a31b-d5e378c9bd8f","type":"message","text":"```263\nruntime: out of memory: cannot allocate 8192-byte block (0 in use)\nfatal error: out of memory```","user":"U03C6TEAZ","ts":"1584003330.357500","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"HVRt8","elements":[{"elements":[{"text":"263\nruntime: out of memory: cannot allocate 8192-byte block (0 in use)\nfatal error: out of memory","type":"text"}],"type":"rich_text_preformatted"}],"type":"rich_text"}]},{"client_msg_id":"98576856-672d-474b-acf8-eedf54e4fd06","type":"message","text":"263?","user":"U06BRP8VD","ts":"1584003368.357800","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"vga","elements":[{"elements":[{"text":"263?","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"7ebca364-6ef6-472d-8329-55a35df6f33c","type":"message","text":"ああ、32ビットバイナリが263で止まったってことか?","user":"U06BRP8VD","ts":"1584003383.358200","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"nOV","elements":[{"elements":[{"text":"ああ、32ビットバイナリが263で止まったってことか?","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"4b7cb4b9-cbf4-44c2-bc2c-002be3df49d6","type":"message","text":"ですです。","user":"U03C6TEAZ","ts":"1584003394.358400","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"OH9S9","elements":[{"elements":[{"text":"ですです。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"aa0777c3-607b-43ed-aeff-cc2351d3656d","type":"message","text":"なんでだろ。OSとかカーネルのアレかなぁ。","user":"U06BRP8VD","ts":"1584003711.359000","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"Wxvl","elements":[{"elements":[{"text":"なんでだろ。OSとかカーネルのアレかなぁ。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"f40c2cf5-fa4a-49df-9937-29fc69a8df9d","type":"message","text":"仕事のプログラムを32bitにしたら256MBでも起動した。","user":"U06BRP8VD","ts":"1584003728.359400","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"fL3M+","elements":[{"elements":[{"text":"仕事のプログラムを32bitにしたら256MBでも起動した。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"17b0e4f6-ce1d-4c38-ab1c-6a7d36d17277","type":"message","text":"なんかulimit -vで指定した値の1/2～2/3くらいのVSZで起動するわw","user":"U06BRP8VD","ts":"1584003788.359900","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"l85E","elements":[{"elements":[{"text":"なんかulimit -vで指定した値の1/2～2/3くらいのVSZで起動するわw","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"1b2033c7-f0c7-40bc-8e95-2642c08d3e8f","type":"message","text":"なんだこれ","user":"U06BRP8VD","ts":"1584003789.360200","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"C8PwC","elements":[{"elements":[{"text":"なんだこれ","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"1e3bf73b-60e7-409b-ab7c-2fd61282a607","type":"message","text":"とりあえず仕事のプログラム、59MBあれば起動できることを確認したw 本当に起動するだけだけどw","user":"U06BRP8VD","ts":"1584004064.360800","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"r3fe","elements":[{"elements":[{"text":"とりあえず仕事のプログラム、59MBあれば起動できることを確認したw 本当に起動するだけだけどw","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"d8c32cc9-400a-47a9-82c3-81890db8b839","type":"message","text":"なんだろう。","user":"U03C6TEAZ","ts":"1584004207.361200","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"gbz","elements":[{"elements":[{"text":"なんだろう。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"50313444-b331-4af4-9017-8b9b577998a0","type":"message","text":"AT_PAGESZ が違うとかそんなんあるのかな。","user":"U03C6TEAZ","ts":"1584004219.361600","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"1is","elements":[{"elements":[{"text":"AT_PAGESZ が違うとかそんなんあるのかな。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"fd7ea1fb-4e90-41dc-b206-3c0d5b090861","type":"message","text":"OSなにつかってるです?","user":"U06BRP8VD","ts":"1584004250.361800","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"XO9A","elements":[{"elements":[{"text":"OSなにつかってるです?","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"fdfbdaf3-5205-4a7d-a91c-b3961f358946","type":"message","text":"ubuntu 18.04 です。","user":"U03C6TEAZ","ts":"1584004276.362000","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"j2x6","elements":[{"elements":[{"text":"ubuntu 18.04 です。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"1321f350-66b0-4bd5-a9db-30683097685e","type":"message","text":"```LD_SHOW_AUXV=1 sleep 1000```\nこれで AT_PAGESZ 何が出ますか？","user":"U03C6TEAZ","ts":"1584004287.362300","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"SiT","elements":[{"elements":[{"text":"LD_SHOW_AUXV=1 sleep 1000","type":"text"}],"type":"rich_text_preformatted"},{"elements":[{"text":"これで AT_PAGESZ 何が出ますか？","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"35093805-55ab-4287-9de4-cbe9328c3259","type":"message","subtype":"thread_broadcast","text":"いやぁ、これ正鵠でした。ありがとうございます。","user":"U06BRP8VD","ts":"1584004297.362400","thread_ts":"1584002501.345400","blocks":[{"block_id":"Dmc5w","elements":[{"elements":[{"text":"いやぁ、これ正鵠でした。ありがとうございます。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}],"root":{"client_msg_id":"b4852aa2-e9f5-4db6-b8bb-e3389a576680","type":"message","text":"省メモリにしたければ 386 を使えということだったり？","user":"UA4RVLHK7","ts":"1584002501.345400","thread_ts":"1584002501.345400","team":"T03C4RC8V","blocks":[{"block_id":"8tbv","elements":[{"elements":[{"text":"省メモリにしたければ 386 を使えということだったり？","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]}},{"client_msg_id":"6d8e65d8-fec9-42c3-bb4c-ffef4c7ed7cb","type":"message","text":"4096","user":"U06BRP8VD","ts":"1584004333.362800","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"hcr6","elements":[{"elements":[{"text":"4096","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"01e936e7-cfd1-41cc-9c9e-a0c1e83b5754","type":"message","text":"さすがにコレはいっしょでしょ","user":"U06BRP8VD","ts":"1584004338.363100","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"bqw9U","elements":[{"elements":[{"text":"さすがにコレはいっしょでしょ","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"8ddeac28-d4b4-4cd3-b034-2d910f9474f7","type":"message","text":"desuyone-","user":"U03C6TEAZ","ts":"1584004341.363300","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"smAK","elements":[{"elements":[{"text":"desuyone-","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"a347a7f1-f585-4f60-807d-1450d7f95cb5","type":"message","text":"19.10なんでKernelもかなり違うかも。","user":"U06BRP8VD","ts":"1584004356.363600","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"mywpw","elements":[{"elements":[{"text":"19.10なんでKernelもかなり違うかも。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"1b47bd1b-a98f-4198-a905-5af12bedf618","type":"message","text":"なるほど。","user":"U03C6TEAZ","ts":"1584004366.363800","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"l6BF","elements":[{"elements":[{"text":"なるほど。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"871439ed-b958-4f78-9714-e888fd23bf3d","type":"message","text":"5.3.0-40","user":"U06BRP8VD","ts":"1584004381.364000","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"V4Rc","elements":[{"elements":[{"text":"5.3.0-40","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"66bc60a8-86c2-47eb-8cb0-a9862385b76a","type":"message","text":"いやーまぁ32bitのほうが思想的には正しいよな…","user":"U06BRP8VD","ts":"1584004522.364600","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"laDB","elements":[{"elements":[{"text":"いやーまぁ32bitのほうが思想的には正しいよな…","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"f3906845-2bca-4b1f-9902-304effb76f2b","type":"message","text":"アロケートのサイズがアーキテクチャで固定になるので OS 側が取れないと判断する量が違うって事になるのか。","user":"U03C6TEAZ","ts":"1584004642.367200","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"RyWR","elements":[{"elements":[{"text":"アロケートのサイズがアーキテクチャで固定になるので OS 側が取れないと判断する量が違うって事になるのか。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}],"edited":{"user":"U03C6TEAZ","ts":"1584004658.000000"}},{"client_msg_id":"ba48c9b2-1a63-465f-8dc1-8dc04fb811a1","type":"message","text":"18.04 だと 4.15.0-88 とかかな &gt; kernel","user":"U06ECBRTJ","ts":"1584004667.367900","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"Ml3zp","elements":[{"elements":[{"text":"18.04 だと 4.15.0-88 とかかな > kernel","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"0b4a2d80-3fdf-4ad1-85c8-da1547581154","type":"message","text":"そんな違うんかー","user":"U03C6TEAZ","ts":"1584004685.368300","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"0Nj","elements":[{"elements":[{"text":"そんな違うんかー","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"4bcf1976-4734-4dd7-8a29-f978a726c1a9","type":"message","text":"あ、違う違う。指定は同じなんだから新しめの OS で 32bit のアプリがページ取らないって話だ。","user":"U03C6TEAZ","ts":"1584006584.370200","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"PBBQ","elements":[{"elements":[{"text":"あ、違う違う。指定は同じなんだから新しめの OS で 32bit のアプリがページ取らないって話だ。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"4c73335a-6dca-4354-b506-56d7b3c2a4d5","type":"message","text":"18.04.4 から  5.3.0-40 ですね。","user":"ULXMF1BC1","ts":"1584006604.370300","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"Qzl","elements":[{"elements":[{"text":"18.04.4 から  5.3.0-40 ですね。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"1da90c96-928a-4902-a34c-a01876192839","type":"message","text":"帰ったらカーネルのバージョン上げて確認してみるかー。","user":"U03C6TEAZ","ts":"1584006656.371000","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"R0C/A","elements":[{"elements":[{"text":"帰ったらカーネルのバージョン上げて確認してみるかー。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"6ba0cf04-7f59-4a3b-9891-1b01499e8772","type":"message","text":"<https://packages.ubuntu.com/bionic/linux-generic>\nんー 18.04.4 のパッケージはどこなんだろう…","user":"U06ECBRTJ","ts":"1584007313.372500","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","attachments":[{"service_name":"packages.ubuntu.com","title":"Ubuntu – Details of package linux-generic in bionic","title_link":"https://packages.ubuntu.com/bionic/linux-generic","text":"Complete Generic Linux kernel and headers","fallback":"Ubuntu – Details of package linux-generic in bionic","from_url":"https://packages.ubuntu.com/bionic/linux-generic","service_icon":"https://packages.ubuntu.com/favicon.ico","id":1,"original_url":"https://packages.ubuntu.com/bionic/linux-generic"}],"blocks":[{"block_id":"mFx","elements":[{"elements":[{"type":"link","url":"https://packages.ubuntu.com/bionic/linux-generic"},{"text":"\nんー 18.04.4 のパッケージはどこなんだろう…","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"613eea7d-346c-42c6-a695-83847c01005a","type":"message","text":"<https://blog.bokuweb.me/entry/wasm>\nRustでGo","user":"UAZ33BKV2","ts":"1584007433.372900","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","attachments":[{"service_name":"undefined","title":"Rustで書いたWebAssemblyインタプリタ上でGoで書いたゲームボーイエミュレータを動かした - undefined","title_link":"https://blog.bokuweb.me/entry/wasm","text":"概要 最近はWebAssemblyに興味があり、勉強していたんだけど仕様を読み始めても頭に入らないのでインタプリタを作ってみることにした。よくわからないものは作ってみるのが一番よい。 <http://github.com|github.com> まだ残された課題は多いのだけれども、一つ目標にしていた「Goで書いたゲームボーイエミュレータを動かす」を達成できたのでここに書いておく。 うおーついにRustで書いた自作wasm interpreter上でgoで書いた自作gameboy emulatorが動いたー！けど1FPSくらいしかでない... <http://pic.twitter.com/I5B2XL5E0W—|pic.twitter.com/I5B2XL5E0W—> bokuweb (@bokuweb1…","fallback":"undefined: Rustで書いたWebAssemblyインタプリタ上でGoで書いたゲームボーイエミュレータを動かした - undefined","from_url":"https://blog.bokuweb.me/entry/wasm","service_icon":"https://cdn.image.st-hatena.com/image/apple_touch_icon/f5fb7fd0a3a2ceb255c50acc5755098a9d831f38/version=1/https%3A%2F%2Fcdn.user.blog.st-hatena.com%2Fcustom_blog_icon%2F103318441%2F1514229229340089","id":1,"original_url":"https://blog.bokuweb.me/entry/wasm"}],"blocks":[{"block_id":"abDO","elements":[{"elements":[{"type":"link","url":"https://blog.bokuweb.me/entry/wasm"},{"text":"\nRustでGo","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"fe5c61e8-4aaa-44a6-b047-d775dd530a1c","type":"message","text":"<https://packages.ubuntu.com/bionic/linux-generic-hwe-18.04> が default になった、ということですね。","user":"ULXMF1BC1","ts":"1584007802.373100","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","attachments":[{"service_name":"packages.ubuntu.com","title":"Ubuntu – Details of package linux-generic-hwe-18.04 in bionic","title_link":"https://packages.ubuntu.com/bionic/linux-generic-hwe-18.04","text":"Complete Generic Linux kernel and headers","fallback":"Ubuntu – Details of package linux-generic-hwe-18.04 in bionic","from_url":"https://packages.ubuntu.com/bionic/linux-generic-hwe-18.04","service_icon":"https://packages.ubuntu.com/favicon.ico","id":1,"original_url":"https://packages.ubuntu.com/bionic/linux-generic-hwe-18.04"}],"blocks":[{"block_id":"1nz","elements":[{"elements":[{"type":"link","url":"https://packages.ubuntu.com/bionic/linux-generic-hwe-18.04"},{"text":" が default になった、ということですね。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}],"reactions":[{"name":"naruhodo","users":["U06ECBRTJ"],"count":1}]},{"client_msg_id":"cc40600f-d989-46c3-b59a-e93e500ddb58","type":"message","text":"相変わらずbokuwebさんはこの道を突き進んでいるなぁ笑","user":"UGXMRNBUM","ts":"1584008074.373700","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"uHFwp","elements":[{"elements":[{"text":"相変わらずbokuwebさんはこの道を突き進んでいるなぁ笑","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"89d8c9f6-7928-44f9-8c93-b8f2cc6fcf0d","type":"message","text":"凄いですよねこれ。","user":"U03C6TEAZ","ts":"1584008100.374000","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"rmv","elements":[{"elements":[{"text":"凄いですよねこれ。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"291b1baa-3b93-4bb9-9e9a-d5512525f9e0","type":"message","text":"Go はまぁビルドするだけなんかも知れんけど。","user":"U03C6TEAZ","ts":"1584008124.374700","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"92o","elements":[{"elements":[{"text":"Go はまぁビルドするだけなんかも知れんけど。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"522ae7d3-2924-4f4c-a2fa-9bfcbefc1105","type":"message","text":"何かとインタプリタとかエミュレーターへの情熱が凄いですわ…","user":"UGXMRNBUM","ts":"1584008162.375600","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"zjW","elements":[{"elements":[{"text":"何かとインタプリタとかエミュレーターへの情熱が凄いですわ…","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]}]
