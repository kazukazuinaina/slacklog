[{"type":"message","subtype":"channel_join","text":"<@U0119AFDQMN> has joined the channel","user":"U0119AFDQMN","ts":"1585788391.112400"},{"type":"message","subtype":"channel_join","text":"<@U76JFPV7T> has joined the channel","user":"U76JFPV7T","ts":"1585792756.112700"},{"client_msg_id":"dceee36b-3730-4e1a-8b68-aee3fd8e8050","type":"message","text":"<https://vim-jp.slack.com/archives/CQ57P4XU4/p1585751019107900>\n自分も再現しないですね……。 `g:asyncomplete_preprocessor` を自前でやってるのが理由かと思ってデフォルトでやってみましたが無事にポップアップは出ませんでした。","user":"UBNPMJJGM","ts":"1585795104.114000","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","attachments":[{"author_icon":"https://avatars.slack-edge.com/2018-05-31/373472791093_ed16847a152da533e013_48.png","author_name":"Tsuyoshi CHO","author_subname":"Tsuyoshi CHO","text":"お暇なasyncomplete利用者のかたへ\nもしよければ、以下の操作での結果がどうなったか、教えていただけますか?\n1. 環境的にはpopupで補完が出る状況 + C-eなどにキャンセルがマップされてること\n2. 補完が行なわれるバッファでキー入力開始\n3. 補完の途中の状態でC-eなどで補完キャンセル\n4. そのままinsert modeの状態でスペースを入力\n```inoremap &lt;expr&gt; &lt;C-e&gt; pumvisible() ? asyncomplete#cancel_popup() : \"\\&lt;C-e&gt;\"```\n確認したいこと: キャンセルした補完がポップアップされるか?\n(ポップアップが出ない、あるいは違う内容の補完が始まるなら、期待動作のはず、同じ補完が出ちゃうのはたぶん期待外動作)","fallback":"[April 1st, 2020 7:23 AM] tsuyoshi_cho: お暇なasyncomplete利用者のかたへ\nもしよければ、以下の操作での結果がどうなったか、教えていただけますか?\n1. 環境的にはpopupで補完が出る状況 + C-eなどにキャンセルがマップされてること\n2. 補完が行なわれるバッファでキー入力開始\n3. 補完の途中の状態でC-eなどで補完キャンセル\n4. そのままinsert modeの状態でスペースを入力\n```inoremap &lt;expr&gt; &lt;C-e&gt; pumvisible() ? asyncomplete#cancel_popup() : \"\\&lt;C-e&gt;\"```\n確認したいこと: キャンセルした補完がポップアップされるか?\n(ポップアップが出ない、あるいは違う内容の補完が始まるなら、期待動作のはず、同じ補完が出ちゃうのはたぶん期待外動作)","from_url":"https://vim-jp.slack.com/archives/CQ57P4XU4/p1585751019107900","id":1,"original_url":"https://vim-jp.slack.com/archives/CQ57P4XU4/p1585751019107900","footer":"Posted in #lsp"}],"blocks":[{"block_id":"qT6","elements":[{"elements":[{"type":"link","url":"https://vim-jp.slack.com/archives/CQ57P4XU4/p1585751019107900"},{"text":"\n自分も再現しないですね……。 ","type":"text"},{"style":{"code":true},"text":"g:asyncomplete_preprocessor","type":"text"},{"text":" を自前でやってるのが理由かと思ってデフォルトでやってみましたが無事にポップアップは出ませんでした。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"0cb618dd-9f42-4d14-8b28-d536e89d32a2","type":"message","text":"ありがとうございます。\nなにかしら自分環境由来なんでしょうね...(現在lspが変なのでそちらから調査中...)","user":"UAZ33BKV2","ts":"1585796114.115000","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"zS9P","elements":[{"elements":[{"text":"ありがとうございます。\nなにかしら自分環境由来なんでしょうね...(現在lspが変なのでそちらから調査中...)","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"3aa4b28a-366a-4e85-bc18-42f3a198ec08","type":"message","text":"lsp_server_initが飛んでない...","user":"UAZ33BKV2","ts":"1585798671.115100","blocks":[{"block_id":"aHV","elements":[{"elements":[{"text":"lsp_server_initが飛んでない...","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}],"files":[{"id":"F010ZK0RH25","created":1585798669,"timestamp":1585798669,"name":"lsp_event.log","title":"lsp_event.log","mimetype":"text/plain","filetype":"text","pretty_type":"Plain Text","user":"UAZ33BKV2","editable":true,"size":1609,"mode":"snippet","is_external":false,"external_type":"","is_public":true,"public_url_shared":false,"display_as_bot":false,"username":"","url_private":"https://files.slack.com/files-pri/T03C4RC8V-F010ZK0RH25/lsp_event.log","url_private_download":"https://files.slack.com/files-pri/T03C4RC8V-F010ZK0RH25/download/lsp_event.log","permalink":"https://vim-jp.slack.com/files/UAZ33BKV2/F010ZK0RH25/lsp_event.log","permalink_public":"https://slack-files.com/T03C4RC8V-F010ZK0RH25-053a483705","edit_link":"https://vim-jp.slack.com/files/UAZ33BKV2/F010ZK0RH25/lsp_event.log/edit","is_starred":false,"has_rich_preview":false}],"upload":true},{"client_msg_id":"9c6c9000-aa8c-4955-acfb-ec9bab85e920","type":"message","text":"sensoredしたログ、普通に動いてる、よな?\nちなみにgoplsでも同じ症状だったので(ログはまだ)、たぶんlspサーバの個体差じゃないとは思うが...(ただstderrの出力あるのは気になる)","user":"UAZ33BKV2","ts":"1585798845.115400","blocks":[{"block_id":"KTj","elements":[{"elements":[{"text":"sensoredしたログ、普通に動いてる、よな?\nちなみにgoplsでも同じ症状だったので(ログはまだ)、たぶんlspサーバの個体差じゃないとは思うが...(ただstderrの出力あるのは気になる)","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}],"files":[{"id":"F0118UAR005","created":1585798843,"timestamp":1585798843,"name":"lsp.log","title":"lsp.log","mimetype":"text/plain","filetype":"text","pretty_type":"Plain Text","user":"UAZ33BKV2","editable":true,"size":29064,"mode":"snippet","is_external":false,"external_type":"","is_public":true,"public_url_shared":false,"display_as_bot":false,"username":"","url_private":"https://files.slack.com/files-pri/T03C4RC8V-F0118UAR005/lsp.log","url_private_download":"https://files.slack.com/files-pri/T03C4RC8V-F0118UAR005/download/lsp.log","permalink":"https://vim-jp.slack.com/files/UAZ33BKV2/F0118UAR005/lsp.log","permalink_public":"https://slack-files.com/T03C4RC8V-F0118UAR005-ea3bc50038","edit_link":"https://vim-jp.slack.com/files/UAZ33BKV2/F0118UAR005/lsp.log/edit","is_starred":false,"has_rich_preview":false}],"upload":true},{"type":"message","subtype":"channel_join","text":"<@U010XRFH7D1> has joined the channel","user":"U010XRFH7D1","ts":"1585799489.115800"},{"type":"message","subtype":"channel_join","text":"<@ULSB0AGHH> has joined the channel","user":"ULSB0AGHH","ts":"1585800183.116100"},{"client_msg_id":"b6ab1fae-e70a-441d-bc0b-233455d4523c","type":"message","text":"上の状況のvimでomnifuncにlsp#completeをセットすれば普通に補完したので、vim-lsp側とlsp連携がまったくできてない、とかではない様子","user":"UAZ33BKV2","ts":"1585800246.117600","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"fPHwA","elements":[{"elements":[{"text":"上の状況のvimでomnifuncにlsp#completeをセットすれば普通に補完したので、vim-lsp側とlsp連携がまったくできてない、とかではない様子","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"ff8a6faa-430e-4bc7-87be-27e1d3f1022f","type":"message","text":"gopls、Windowsで Access Deniedでインストール失敗にあう...うぅ","user":"UAZ33BKV2","ts":"1585800441.118300","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"FpZjW","elements":[{"elements":[{"text":"gopls、Windowsで Access Deniedでインストール失敗にあう...うぅ","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"7ee2fecc-3ed7-4d65-accd-4a152f9bbf67","type":"message","text":"`81 C:\\Users\\&lt;username&gt;\\.local\\share\\vim-lsp-settings\\gopls\\pkg\\mod\\<http://golang.org|golang.org>\\x\\tools@v0.0.0-20200316194252-fafb6e2e8a4a: Access is denied`","user":"UAZ33BKV2","ts":"1585800489.118500","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"dn/","elements":[{"elements":[{"style":{"code":true},"text":"81 C:\\Users\\<username>\\.local\\share\\vim-lsp-settings\\gopls\\pkg\\mod\\","type":"text"},{"style":{"code":true},"text":"golang.org","type":"link","url":"http://golang.org"},{"style":{"code":true},"text":"\\x\\tools@v0.0.0-20200316194252-fafb6e2e8a4a: Access is denied","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"d90ef196-d300-42e4-92f7-9c9f5434a58d","type":"message","text":"なおLinux環境でもvim-lspの挙動は同じだった","user":"UAZ33BKV2","ts":"1585800908.118900","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"5bm","elements":[{"elements":[{"text":"なおLinux環境でもvim-lspの挙動は同じだった","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"3ea9b635-0771-453b-91bd-2b3f550dc9b8","type":"message","text":"asyncompleteのC-eでマッピングして補完キャンセルしてスペース入力のですが、僕の手元でもポップアップは出ませんでした","user":"U7TMPGWJ0","ts":"1585802178.120000","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"6q2","elements":[{"elements":[{"text":"asyncompleteのC-eでマッピングして補完キャンセルしてスペース入力のですが、僕の手元でもポップアップは出ませんでした","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"34066a60-fb88-4403-bd23-856948a905b2","type":"message","text":"ありがとうございます...なんだろうなあ","user":"UAZ33BKV2","ts":"1585802295.120300","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"Lm3","elements":[{"elements":[{"text":"ありがとうございます...なんだろうなあ","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"09ee186f-bc9d-4a0e-bb5f-7015a33687eb","type":"message","text":"vim-lspが lsp_server_init出してないというのがあったので、これはvim-lspにほぼ完結してるはず、とissue出しました","user":"UAZ33BKV2","ts":"1585802333.121100","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"TEU","elements":[{"elements":[{"text":"vim-lspが lsp_server_init出してないというのがあったので、これはvim-lspにほぼ完結してるはず、とissue出しました","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"c1996fc1-4dee-49d9-a242-72673344ed30","type":"message","text":"むー","user":"UAZ33BKV2","ts":"1585802337.121300","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"8Abx2","elements":[{"elements":[{"text":"むー","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"0ad531dd-bb62-4b06-b68f-e6e076d6bda7","type":"message","text":"asyncompleteはかなり謎...","user":"UAZ33BKV2","ts":"1585802352.121800","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"uwVn","elements":[{"elements":[{"text":"asyncompleteはかなり謎...","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"bbc3bf10-5aaa-48fe-a05c-af064c4669cc","type":"message","text":"最小構成ってどんなのでしたっけ？","user":"U7TMPGWJ0","ts":"1585802362.122000","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"ZT7x","elements":[{"elements":[{"text":"最小構成ってどんなのでしたっけ？","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"7671f8f2-af36-4174-afbc-cee6be004e0d","type":"message","text":"自分が\n• asyncompleteのソースがいろいろ\n• 調べたらasyncomplete-lsp/vim-lspが連動してなかった(のでlspだけにできなかった)\n• 最小と言えるか不明だが、asyncomplete-emoji単体でも出た(これoffかつ他のでも出るので、emojiが悪いとも思えない)","user":"UAZ33BKV2","ts":"1585802426.123300","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"RwB","elements":[{"elements":[{"text":"自分が\n","type":"text"}],"type":"rich_text_section"},{"elements":[{"elements":[{"text":"asyncompleteのソースがいろいろ","type":"text"}],"type":"rich_text_section"},{"elements":[{"text":"調べたらasyncomplete-lsp/vim-lspが連動してなかった(のでlspだけにできなかった)","type":"text"}],"type":"rich_text_section"},{"elements":[{"text":"最小と言えるか不明だが、asyncomplete-emoji単体でも出た(これoffかつ他のでも出るので、emojiが悪いとも思えない)","type":"text"}],"type":"rich_text_section"}],"indent":0,"style":"bullet","type":"rich_text_list"}],"type":"rich_text"}]},{"client_msg_id":"f490759b-b4a3-4a5b-8673-20e35e1189f3","type":"message","text":"ですかね","user":"UAZ33BKV2","ts":"1585802429.123500","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"MCU","elements":[{"elements":[{"text":"ですかね","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"973550bb-ec1f-4e7c-9386-8994b6d8f5ce","type":"message","text":"僕はasyncomplete-lspしか入れてない環境ですね","user":"U7TMPGWJ0","ts":"1585802456.124300","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"5Nwu","elements":[{"elements":[{"text":"僕はasyncomplete-lspしか入れてない環境ですね","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"f4c30de8-904c-4100-9b9d-2bace813de66","type":"message","text":"最小化にするにはちょっと環境がいじりにくくなってて、詰めれてません...すみませぬ","user":"UAZ33BKV2","ts":"1585802459.124400","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"Nq1M","elements":[{"elements":[{"text":"最小化にするにはちょっと環境がいじりにくくなってて、詰めれてません...すみませぬ","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"deb20ea4-bdc5-435f-948d-0d26c5997c72","type":"message","text":"(なのでlspだけにしたかったんですが)","user":"UAZ33BKV2","ts":"1585802473.124900","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"lo41","elements":[{"elements":[{"text":"(なのでlspだけにしたかったんですが)","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"18aadfe8-7d8a-4915-87b3-931d966a92cb","type":"message","text":"なるほどー。dockerかなにかでちょろっと流してみます","user":"U7TMPGWJ0","ts":"1585802484.125200","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"WJSK","elements":[{"elements":[{"text":"なるほどー。dockerかなにかでちょろっと流してみます","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"6a9a1571-960b-4ac7-bd90-f05a2fa9cc51","type":"message","text":"ありがとうございます。","user":"UAZ33BKV2","ts":"1585802494.125400","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"uuCg","elements":[{"elements":[{"text":"ありがとうございます。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"cf411575-9847-497e-9dfa-5527152373dc","type":"message","text":"<https://gist.github.com/tsuyoshicho/0bab16b946cf4fbbb7c540ac03c18664>\n秘密(でもなんでもない) ログのfull","user":"UAZ33BKV2","ts":"1585802517.125700","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"n91d","elements":[{"elements":[{"type":"link","url":"https://gist.github.com/tsuyoshicho/0bab16b946cf4fbbb7c540ac03c18664"},{"text":"\n秘密(でもなんでもない) ログのfull","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"f5c3ff5d-87ca-43b0-a776-868f8e7d141c","type":"message","text":"結構長くハマってますよね。。つらそう。。","user":"U7TMPGWJ0","ts":"1585802601.126000","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"wsW","elements":[{"elements":[{"text":"結構長くハマってますよね。。つらそう。。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"3366fe1a-0717-4b87-a028-1a7062c0429c","type":"message","text":"他のこといろいろやってるので、ボチボチやってる、というのはあります\n前は補完動いたし、そっから特に設定はしてない(できる要素がない)んですけどねえ...","user":"UAZ33BKV2","ts":"1585802654.126800","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"krhPw","elements":[{"elements":[{"text":"他のこといろいろやってるので、ボチボチやってる、というのはあります\n前は補完動いたし、そっから特に設定はしてない(できる要素がない)んですけどねえ...","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"cf5729d8-8e21-4bea-8922-7e0f56711339","type":"message","text":"問題点はasyncompleteのソースを色々入れたら補完キャンセルでスペースで再ポップアップされちゃうことでしたでしょうか？","user":"U7TMPGWJ0","ts":"1585803166.128400","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"yHC","elements":[{"elements":[{"text":"問題点はasyncompleteのソースを色々入れたら補完キャンセルでスペースで再ポップアップされちゃうことでしたでしょうか？","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"121d0293-3a11-4ffd-831a-a024bfb51f9b","type":"message","text":"見える症状はそうですね\n• asyncomplete補完開始\n• asyncompleteのcancel実施\n• insertのままスペース入力\n• キャンセルした内容の補完popupが出る\nこれ単体は実は害がほとんどないんですが、挙動が変なので調査しだしたら、いろいろ(自分の環境の?)問題が見えてきまして...","user":"UAZ33BKV2","ts":"1585803334.129900","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"NZgK","elements":[{"elements":[{"text":"見える症状はそうですね\n","type":"text"}],"type":"rich_text_section"},{"elements":[{"elements":[{"text":"asyncomplete補完開始","type":"text"}],"type":"rich_text_section"},{"elements":[{"text":"asyncompleteのcancel実施","type":"text"}],"type":"rich_text_section"},{"elements":[{"text":"insertのままスペース入力","type":"text"}],"type":"rich_text_section"},{"elements":[{"text":"キャンセルした内容の補完popupが出る","type":"text"}],"type":"rich_text_section"}],"indent":0,"style":"bullet","type":"rich_text_list"},{"elements":[{"text":"これ単体は実は害がほとんどないんですが、挙動が変なので調査しだしたら、いろいろ(自分の環境の?)問題が見えてきまして...","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"172d8e1d-e000-4568-a7a5-664113de240f","type":"message","text":"lspだけにして確認しようとしたら、lspがasyncompleteと連携してなかったorz、というのもあり確認が難航しています(他の人でOKの状態にしてから進めたかった)","user":"UAZ33BKV2","ts":"1585803369.130600","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"3m5","elements":[{"elements":[{"text":"lspだけにして確認しようとしたら、lspがasyncompleteと連携してなかったorz、というのもあり確認が難航しています(他の人でOKの状態にしてから進めたかった)","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"3de988c4-5b87-44c3-a191-9aee20215a27","type":"message","text":"こんなのでUbuntuのfocalで試しましたがvim-language-serverもpylsも普通にC-eのあとにスペースでポップアップはでませんでしたね。改めてlsp単体のasyncompleteの連携は問題なさそう\n```call plug#begin('~/.vim/plugged')\nPlug 'prabirshrestha/async.vim'\nPlug 'prabirshrestha/vim-lsp'\nPlug 'prabirshrestha/asyncomplete.vim'\nPlug 'prabirshrestha/asyncomplete-lsp.vim'\nPlug 'mattn/vim-lsp-settings'\ncall plug#end()\n\naugroup LspMappings\n  au!\n  au FileType vim,python call s:lsp_common_mappings()\naugroup END\n\nfunction! s:lsp_common_mappings() abort\n  setlocal omnifunc=lsp#complete\n  nmap &lt;buffer&gt; K &lt;Plug&gt;(lsp-hover)\n  nmap &lt;buffer&gt; &lt;silent&gt; [g &lt;Plug&gt;(lsp-previous-diagnostic)\n  nmap &lt;buffer&gt; &lt;silent&gt; ]g &lt;Plug&gt;(lsp-next-diagnostic)\n  nmap &lt;buffer&gt; gd &lt;Plug&gt;(lsp-definition)\nendfunction\n\ninoremap &lt;expr&gt; &lt;C-y&gt; pumvisible() ? asyncomplete#close_popup() : \"\\&lt;C-y&gt;\"\ninoremap &lt;expr&gt; &lt;C-e&gt; pumvisible() ? asyncomplete#cancel_popup() : \"\\&lt;C-e&gt;\"```","user":"U7TMPGWJ0","ts":"1585803533.131000","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"ha9","elements":[{"elements":[{"text":"こんなのでUbuntuのfocalで試しましたがvim-language-serverもpylsも普通にC-eのあとにスペースでポップアップはでませんでしたね。改めてlsp単体のasyncompleteの連携は問題なさそう\n","type":"text"}],"type":"rich_text_section"},{"elements":[{"text":"call plug#begin('~/.vim/plugged')\nPlug 'prabirshrestha/async.vim'\nPlug 'prabirshrestha/vim-lsp'\nPlug 'prabirshrestha/asyncomplete.vim'\nPlug 'prabirshrestha/asyncomplete-lsp.vim'\nPlug 'mattn/vim-lsp-settings'\ncall plug#end()\n\naugroup LspMappings\n  au!\n  au FileType vim,python call s:lsp_common_mappings()\naugroup END\n\nfunction! s:lsp_common_mappings() abort\n  setlocal omnifunc=lsp#complete\n  nmap <buffer> K <Plug>(lsp-hover)\n  nmap <buffer> <silent> [g <Plug>(lsp-previous-diagnostic)\n  nmap <buffer> <silent> ]g <Plug>(lsp-next-diagnostic)\n  nmap <buffer> gd <Plug>(lsp-definition)\nendfunction\n\ninoremap <expr> <C-y> pumvisible() ? asyncomplete#close_popup() : \"\\<C-y>\"\ninoremap <expr> <C-e> pumvisible() ? asyncomplete#cancel_popup() : \"\\<C-e>\"","type":"text"}],"type":"rich_text_preformatted"}],"type":"rich_text"}]},{"client_msg_id":"845aa32c-2e67-4ecb-be25-5d1156b91610","type":"message","text":"asyncompeteのソース、色々をためしてみます。","user":"U7TMPGWJ0","ts":"1585803570.131500","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"xlxU","elements":[{"elements":[{"text":"asyncompeteのソース、色々をためしてみます。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"5afcd022-09b6-43c3-a2e3-1d4d16445fce","type":"message","text":"ありがとうございます。やっぱりlsp側連携は問題ないか...","user":"UAZ33BKV2","ts":"1585803700.131900","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"Rf4","elements":[{"elements":[{"text":"ありがとうございます。やっぱりlsp側連携は問題ないか...","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"8e86fbe5-4fcd-4bc8-a429-1283512be85d","type":"message","text":"asyncompleteとasyncomplete-emojiでやってみましたが絵文字補完(:smile: とか)中に asyncomplete 用の C-e のキャンセルをしてスペース入力で。ポップアップは出ませんでしたね。","user":"U7TMPGWJ0","ts":"1585804939.132100","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"B01eJ","elements":[{"elements":[{"text":"asyncompleteとasyncomplete-emojiでやってみましたが絵文字補完(","type":"text"},{"name":"smile","type":"emoji"},{"text":" とか)中に asyncomplete 用の C-e のキャンセルをしてスペース入力で。ポップアップは出ませんでしたね。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}],"edited":{"user":"U7TMPGWJ0","ts":"1585804968.000000"}},{"client_msg_id":"70130faf-9105-4841-ab33-fe9314a1ecac","type":"message","text":"おー、絵文字展開されちゃうか。まーそうか。","user":"U7TMPGWJ0","ts":"1585804981.132600","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"T0nCD","elements":[{"elements":[{"text":"おー、絵文字展開されちゃうか。まーそうか。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"60172c31-ebf9-4f87-b173-6155257749ff","type":"message","text":"ありがとうございます。こちらも上の最小構成を試し中です...","user":"UAZ33BKV2","ts":"1585805101.133100","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"Y/Q1w","elements":[{"elements":[{"text":"ありがとうございます。こちらも上の最小構成を試し中です...","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"414d05fc-2919-4426-b21b-d3d0e5088f7a","type":"message","text":"ちなみに雑にこれだけで試しました(asyncomplete-emojiのはREADMEにあるそのままのそれで)\n```call plug#begin('~/.vim/plugged')\nPlug 'prabirshrestha/asyncomplete.vim'\nPlug 'prabirshrestha/asyncomplete-emoji.vim'\ncall plug#end()\n\ninoremap &lt;expr&gt; &lt;C-e&gt; pumvisible() ? asyncomplete#cancel_popup() : \"\\&lt;C-e&gt;\"\n\nau User asyncomplete_setup call asyncomplete#register_source(asyncomplete#sources#emoji#get_source_options({\n    \\ 'name': 'emoji',\n    \\ 'whitelist': ['*'],\n    \\ 'completor': function('asyncomplete#sources#emoji#completor'),\n    \\ }))```","user":"U7TMPGWJ0","ts":"1585805243.133900","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"xTm","elements":[{"elements":[{"text":"ちなみに雑にこれだけで試しました(asyncomplete-emojiのはREADMEにあるそのままのそれで)\n","type":"text"}],"type":"rich_text_section"},{"elements":[{"text":"call plug#begin('~/.vim/plugged')\nPlug 'prabirshrestha/asyncomplete.vim'\nPlug 'prabirshrestha/asyncomplete-emoji.vim'\ncall plug#end()\n\ninoremap <expr> <C-e> pumvisible() ? asyncomplete#cancel_popup() : \"\\<C-e>\"\n\nau User asyncomplete_setup call asyncomplete#register_source(asyncomplete#sources#emoji#get_source_options({\n    \\ 'name': 'emoji',\n    \\ 'whitelist': ['*'],\n    \\ 'completor': function('asyncomplete#sources#emoji#completor'),\n    \\ }))","type":"text"}],"type":"rich_text_preformatted"}],"type":"rich_text"}]},{"client_msg_id":"f9eec93a-b716-4ef0-8aaa-92f9b45f44d7","type":"message","text":"こっちはこんな風でpythonで試し中ですがomni補完でも補完がスタートしない(server は running...)\n<https://gist.github.com/tsuyoshicho/e8bc392f0c602432b9b43fa6380198d6>","user":"UAZ33BKV2","ts":"1585805330.134600","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"2xp+L","elements":[{"elements":[{"text":"こっちはこんな風でpythonで試し中ですがomni補完でも補完がスタートしない(server は running...)\n","type":"text"},{"type":"link","url":"https://gist.github.com/tsuyoshicho/e8bc392f0c602432b9b43fa6380198d6"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"80c89525-7450-4cda-afee-1160b9d18aa4","type":"message","text":"なぜだw","user":"UAZ33BKV2","ts":"1585805339.134800","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"/7bj2","elements":[{"elements":[{"text":"なぜだw","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"341762a9-4b70-430b-9a6d-d92ea73827a3","type":"message","text":"emoji追加して確認したら、補完がキャンセルできるのは見えました。\nただ一文字目の `:` の時点でC-eすると補完がキャンセルできずに再ポップアップするな...これはemojiがバグってる臭いけど","user":"UAZ33BKV2","ts":"1585805492.135900","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"lJue","elements":[{"elements":[{"text":"emoji追加して確認したら、補完がキャンセルできるのは見えました。\nただ一文字目の ","type":"text"},{"style":{"code":true},"text":":","type":"text"},{"text":" の時点でC-eすると補完がキャンセルできずに再ポップアップするな...これはemojiがバグってる臭いけど","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"517de5ae-85fd-4567-a6d7-dd987f07fa16","type":"message","text":"あー、それは再現しました。候補？文字数？によっては再ポップアップしますね","user":"U7TMPGWJ0","ts":"1585805562.136600","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"4rC","elements":[{"elements":[{"text":"あー、それは再現しました。候補？文字数？によっては再ポップアップしますね","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"fd3f1ee7-0d9b-41dd-a39e-5ab79185e996","type":"message","text":"スペースの件とはまた別ですね。","user":"U7TMPGWJ0","ts":"1585805574.137000","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"qKOQ","elements":[{"elements":[{"text":"スペースの件とはまた別ですね。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"0c5c798e-3182-48d3-8657-4a57d57bdaf1","type":"message","text":"やっぱりrefresh設定がダメなソースがどっかにいたんだろう、というのはほぼ確実かなあ","user":"UAZ33BKV2","ts":"1585805594.137400","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"BdRYm","elements":[{"elements":[{"text":"やっぱりrefresh設定がダメなソースがどっかにいたんだろう、というのはほぼ確実かなあ","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"8bb09d19-8e83-4daf-890f-2ac709a3b3db","type":"message","text":"<https://gist.github.com/tsuyoshicho/7882722ea4a1cc6c706b9d82c3997be4>\nemoji入り","user":"UAZ33BKV2","ts":"1585805604.137600","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"R9rz","elements":[{"elements":[{"type":"link","url":"https://gist.github.com/tsuyoshicho/7882722ea4a1cc6c706b9d82c3997be4"},{"text":"\nemoji入り","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"28551c50-6cae-4f09-b527-a66b7ccce29f","type":"message","text":"絵文字のは `:+1:`  を入力しようとして `:+` あたりや  `:-` あたりで C-e すると無限ポップアップはしますね。それくらいかなー","user":"U7TMPGWJ0","ts":"1585805799.139700","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"6D+","elements":[{"elements":[{"text":"絵文字のは ","type":"text"},{"style":{"code":true},"text":":+1:","type":"text"},{"text":"  を入力しようとして ","type":"text"},{"style":{"code":true},"text":":+","type":"text"},{"text":" あたりや  ","type":"text"},{"style":{"code":true},"text":":-","type":"text"},{"text":" あたりで C-e すると無限ポップアップはしますね。それくらいかなー","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"8659b45c-4c94-40fa-b12f-e90c4b507523","type":"message","text":"そうですね、`:smi` あたりで止めるぶんには問題ないので...","user":"UAZ33BKV2","ts":"1585805855.140100","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"G1pDw","elements":[{"elements":[{"text":"そうですね、","type":"text"},{"style":{"code":true},"text":":smi","type":"text"},{"text":" あたりで止めるぶんには問題ないので...","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"ba9574e1-332e-4bff-80b4-f038ebb15d39","type":"message","text":"emoji以外のソースで試すしかないか","user":"UAZ33BKV2","ts":"1585805864.140400","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"foS","elements":[{"elements":[{"text":"emoji以外のソースで試すしかないか","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"f7bf93be-90af-4c27-811a-56fe9974b28d","type":"message","text":": や + や - はなんか許せそう。リフレッシュするパターンからは漏れてそうな気がするし","user":"U7TMPGWJ0","ts":"1585805928.141400","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"9ub8","elements":[{"elements":[{"text":": や + や - はなんか許せそう。リフレッシュするパターンからは漏れてそうな気がするし","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}],"reactions":[{"name":"hai-small","users":["UAZ33BKV2"],"count":1}]},{"client_msg_id":"7b5744a5-9e90-42cf-8006-49aeff33ea25","type":"message","text":"iskeywordに:と+と-をぶちこんだら、再ポップアプしなくなりました","user":"U7TMPGWJ0","ts":"1585806106.142300","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"a01Yw","elements":[{"elements":[{"text":"iskeywordに:と+と-をぶちこんだら、再ポップアプしなくなりました","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"22249863-8290-4d39-b12d-3b4617dbd1a3","type":"message","text":"あ、やはり refresh pattern だったのか。","user":"U03C6TEAZ","ts":"1585806122.142700","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"JrCkM","elements":[{"elements":[{"text":"あ、やはり refresh pattern だったのか。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"d601f6c4-9b8b-43a0-90a4-c9c7c81e5604","type":"message","text":"tagでやったら、c-eで出なくなったので、そこは問題なかったです(報告)","user":"UAZ33BKV2","ts":"1585806208.144200","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"ARt=","elements":[{"elements":[{"text":"tagでやったら、c-eで出なくなったので、そこは問題なかったです(報告)","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"d7fad1ef-6de5-4cc6-a8d6-4a2e248bb668","type":"message","text":"vimのファイルタイプで雑に試したらだいじょぶでした\n```augroup AddKeyword\n  au!\n  au Filetype vim setlocal iskeyword+=:\n  au Filetype vim setlocal iskeyword+=+\n  au Filetype vim setlocal iskeyword+=-\naugroup END```","user":"U7TMPGWJ0","ts":"1585806211.144400","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"me6Vs","elements":[{"elements":[{"text":"vimのファイルタイプで雑に試したらだいじょぶでした\n","type":"text"}],"type":"rich_text_section"},{"elements":[{"text":"augroup AddKeyword\n  au!\n  au Filetype vim setlocal iskeyword+=:\n  au Filetype vim setlocal iskeyword+=+\n  au Filetype vim setlocal iskeyword+=-\naugroup END","type":"text"}],"type":"rich_text_preformatted"}],"type":"rich_text"}]},{"client_msg_id":"180053c3-18a7-48eb-8efd-ea50533b2d6c","type":"message","text":"でも現環境にすると、tagでのキャンセルも再popする...w\niskeywordは同じなんだけどなあ(未変更)","user":"UAZ33BKV2","ts":"1585806301.145100","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"jacRR","elements":[{"elements":[{"text":"でも現環境にすると、tagでのキャンセルも再popする...w\niskeywordは同じなんだけどなあ(未変更)","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"fe0336fe-6135-40ce-94fa-7d27650b960f","type":"message","text":"<@U7TMPGWJ0> さん、<@U03C6TEAZ> さん\nissueとして出してはいるのですが、\n<https://vim-jp.slack.com/archives/CQ57P4XU4/p1585798671115100>\nは、やっぱりなにかしらの環境問題ですよね...","user":"UAZ33BKV2","ts":"1585807552.146200","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","attachments":[{"author_icon":"https://avatars.slack-edge.com/2018-05-31/373472791093_ed16847a152da533e013_48.png","author_name":"Tsuyoshi CHO","author_subname":"Tsuyoshi CHO","text":"lsp_server_initが飛んでない...","fallback":"[April 1st, 2020 8:37 PM] tsuyoshi_cho: lsp_server_initが飛んでない...","from_url":"https://vim-jp.slack.com/archives/CQ57P4XU4/p1585798671115100","id":1,"original_url":"https://vim-jp.slack.com/archives/CQ57P4XU4/p1585798671115100","footer":"Posted in #lsp"}],"blocks":[{"block_id":"pfbmP","elements":[{"elements":[{"type":"user","user_id":"U7TMPGWJ0"},{"text":" さん、","type":"text"},{"type":"user","user_id":"U03C6TEAZ"},{"text":" さん\nissueとして出してはいるのですが、\n","type":"text"},{"type":"link","url":"https://vim-jp.slack.com/archives/CQ57P4XU4/p1585798671115100"},{"text":"\nは、やっぱりなにかしらの環境問題ですよね...","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"898c85ac-140e-4abd-be2f-928c037cc215","type":"message","text":"他の方も動いてるようですので、たしかになにかしら環境問題(vimrc等)なのかもしれませんね...","user":"U7TMPGWJ0","ts":"1585808656.146600","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"g6R3U","elements":[{"elements":[{"text":"他の方も動いてるようですので、たしかになにかしら環境問題(vimrc等)なのかもしれませんね...","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"ce3b6784-2630-43e2-8cb5-57aa53cbbae3","type":"message","text":"むう、一旦環境分解するところから始めないとかなあ...","user":"UAZ33BKV2","ts":"1585808726.147200","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"UYY","elements":[{"elements":[{"text":"むう、一旦環境分解するところから始めないとかなあ...","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"694e7105-9d9e-4d75-b90f-3304bb1bc03f","type":"message","text":"ちょっと整理して、↑の問題はvim-lsp自体は動いてるけどasyncomplete連携(asyncomplete-lsp)がうまくできてないってことですか？","user":"U7TMPGWJ0","ts":"1585808848.148400","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"2dLRp","elements":[{"elements":[{"text":"ちょっと整理して、↑の問題はvim-lsp自体は動いてるけどasyncomplete連携(asyncomplete-lsp)がうまくできてないってことですか？","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"34317f7c-b067-4b46-ac73-4a2f394ee735","type":"message","text":"はい、omniだと補完動いていますが、lsp_server_initが発火しなかったため asyncomplete-lspのsource登録が処理されず、asyncompleteでは動かないことをログから確認しました。\n(次々問題が見えたのはありますが、その中で見付けました。)","user":"UAZ33BKV2","ts":"1585809057.150200","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"ydcD","elements":[{"elements":[{"text":"はい、omniだと補完動いていますが、lsp_server_initが発火しなかったため asyncomplete-lspのsource登録が処理されず、asyncompleteでは動かないことをログから確認しました。\n(次々問題が見えたのはありますが、その中で見付けました。)","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"da3e5e5a-d6e6-44cf-8c2c-ce0895a4f266","type":"message","text":"lsp_server_init は発火しているが、エラーがでて途中で止まっている。という説はなさそうでしょうか。。。？","user":"U8R597E9H","ts":"1585809192.150700","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"3Ym0","elements":[{"elements":[{"text":"lsp_server_init は発火しているが、エラーがでて途中で止まっている。という説はなさそうでしょうか。。。？","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"602b2c57-685e-4711-a1ce-f889ecd85d9f","type":"message","text":"ログに出てませんが、そういう状態になるとログ(自分がセットしたautocmd)出ない状態になりますっけ?\nnestedが必要とかじゃないはずだと思うのですが...","user":"UAZ33BKV2","ts":"1585809245.151500","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"sppE","elements":[{"elements":[{"text":"ログに出てませんが、そういう状態になるとログ(自分がセットしたautocmd)出ない状態になりますっけ?\nnestedが必要とかじゃないはずだと思うのですが...","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"7e2a9d15-dd5d-4908-87e5-a1c779e23f4c","type":"message","text":"<https://vim-jp.slack.com/archives/CQ57P4XU4/p1585802517125700>","user":"UAZ33BKV2","ts":"1585811295.151800","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","attachments":[{"author_icon":"https://avatars.slack-edge.com/2018-05-31/373472791093_ed16847a152da533e013_48.png","author_name":"Tsuyoshi CHO","author_subname":"Tsuyoshi CHO","text":"<https://gist.github.com/tsuyoshicho/0bab16b946cf4fbbb7c540ac03c18664>\n秘密(でもなんでもない) ログのfull","fallback":"[April 1st, 2020 9:41 PM] tsuyoshi_cho: <https://gist.github.com/tsuyoshicho/0bab16b946cf4fbbb7c540ac03c18664>\n秘密(でもなんでもない) ログのfull","from_url":"https://vim-jp.slack.com/archives/CQ57P4XU4/p1585802517125700","id":1,"original_url":"https://vim-jp.slack.com/archives/CQ57P4XU4/p1585802517125700","footer":"Posted in #lsp"}],"blocks":[{"block_id":"LhV","elements":[{"elements":[{"type":"link","url":"https://vim-jp.slack.com/archives/CQ57P4XU4/p1585802517125700"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"d041f3f6-51ce-4917-8ae9-c49b76bee97b","type":"message","text":"関数の途中で例外起きると発火しないですね。init より前だと register?","user":"U03C6TEAZ","ts":"1585812886.153500","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"QWj","elements":[{"elements":[{"text":"関数の途中で例外起きると発火しないですね。init より前だと register?","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"a51e0032-3ca5-4a85-82ca-6a18114d69ca","type":"message","text":"なるほど\nただ、lsp#utils#errorのメッセージはのこってないので、なにが発生したのか不明ですね...(それ以外の例外だとしたら、それはそれでmessagesに残りそうな気もするんですが、ない)","user":"UAZ33BKV2","ts":"1585813270.154900","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"DWUqT","elements":[{"elements":[{"text":"なるほど\nただ、lsp#utils#errorのメッセージはのこってないので、なにが発生したのか不明ですね...(それ以外の例外だとしたら、それはそれでmessagesに残りそうな気もするんですが、ない)","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"629b515b-dfb3-4826-ad70-f83af218accb","type":"message","text":"```2020/04/02 12:25:53:[\"s:on_stdout client option on_notification() error\",\"Vim(call):E20: マークは設定されていません\"]\n2020/04/02 12:25:53:[\"&lt;---(stderr)\",3,\"clangd\",[\"I[12:25:53.899] clangd version 10.0.0 \\r\",\"I[12:25:53.901] Working directory: C:\\\\Users\\\\&lt;username&gt;\\r\",\"I[12:25:53.901] argv[0]: C:\\\\Program Files\\\\LLVM\\\\bin\\\\clangd.exe\\r\",\"I[12:25:53.901] argv[1]: --background-index\\r\",\"I[12:25:53.901] argv[2]: -j=4\\r\",\"I[12:25:53.901] Starting LSP over stdin/stdout\\r\",\"I[12:25:53.901] &lt;-- initialize(1)\\r\",\"I[12:25:53.910] --&gt; reply:initialize(1) 8 ms\\r\",\"\"]]```\nここら変があやしい?","user":"UAZ33BKV2","ts":"1585814384.155400","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"cs3","elements":[{"elements":[{"text":"2020/04/02 12:25:53:[\"s:on_stdout client option on_notification() error\",\"Vim(call):E20: マークは設定されていません\"]\n2020/04/02 12:25:53:[\"<---(stderr)\",3,\"clangd\",[\"I[12:25:53.899] clangd version 10.0.0 \\r\",\"I[12:25:53.901] Working directory: C:\\\\Users\\\\<username>\\r\",\"I[12:25:53.901] argv[0]: C:\\\\Program Files\\\\LLVM\\\\bin\\\\clangd.exe\\r\",\"I[12:25:53.901] argv[1]: --background-index\\r\",\"I[12:25:53.901] argv[2]: -j=4\\r\",\"I[12:25:53.901] Starting LSP over stdin/stdout\\r\",\"I[12:25:53.901] <-- initialize(1)\\r\",\"I[12:25:53.910] --> reply:initialize(1) 8 ms\\r\",\"\"]]","type":"text"}],"type":"rich_text_preformatted"},{"elements":[{"text":"\nここら変があやしい?","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"aa8b267f-f3f6-46c0-85a1-b30994f43457","type":"message","text":"ただ、これはclangdで、というだけで、他も同じ挙動だったような","user":"UAZ33BKV2","ts":"1585814428.155900","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"NEM","elements":[{"elements":[{"text":"ただ、これはclangdで、というだけで、他も同じ挙動だったような","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"1954c85f-e218-4781-b0eb-87685556c94c","type":"message","text":"外して確認してみよう...","user":"UAZ33BKV2","ts":"1585814435.156100","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"2ZpOp","elements":[{"elements":[{"text":"外して確認してみよう...","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"41d76255-787f-4480-a742-15a14e8f9312","type":"message","text":"```2020/04/02 17:03:51:[\"s:on_stdout client option on_notification() error\",\"Vim(call):E20: マークは設定されていません\"]\n2020/04/02 17:03:51:[\"&lt;---(stderr)\",3,\"clangd\",[\"I[17:03:51.380] clangd version 10.0.0 \\r\",\"I[17:03:51.382] Working directory: C:\\\\Users\\\\&lt;username&gt;\\r\",\"I[17:03:51.382] argv[0]: C:\\\\Program Files\\\\LLVM\\\\bin\\\\clangd.exe\\r\",\"I[17:03:51.382] Starting LSP over stdin/stdout\\r\",\"I[17:03:51.384] &lt;-- initialize(1)\\r\",\"I[17:03:51.393] --&gt; reply:initialize(1) 8 ms\\r\",\"\"]]```\nオプションの設定を外してもかわらない...","user":"UAZ33BKV2","ts":"1585814838.156900","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"ZI4j","elements":[{"elements":[{"text":"2020/04/02 17:03:51:[\"s:on_stdout client option on_notification() error\",\"Vim(call):E20: マークは設定されていません\"]\n2020/04/02 17:03:51:[\"<---(stderr)\",3,\"clangd\",[\"I[17:03:51.380] clangd version 10.0.0 \\r\",\"I[17:03:51.382] Working directory: C:\\\\Users\\\\<username>\\r\",\"I[17:03:51.382] argv[0]: C:\\\\Program Files\\\\LLVM\\\\bin\\\\clangd.exe\\r\",\"I[17:03:51.382] Starting LSP over stdin/stdout\\r\",\"I[17:03:51.384] <-- initialize(1)\\r\",\"I[17:03:51.393] --> reply:initialize(1) 8 ms\\r\",\"\"]]","type":"text"}],"type":"rich_text_preformatted"},{"elements":[{"text":"\nオプションの設定を外してもかわらない...","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"04bdb1f2-db35-4fa5-b86e-e36d8a474f76","type":"message","text":"Linuxもそうだし、影響はないか...\nただE20は気になる","user":"UAZ33BKV2","ts":"1585814929.157400","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"1CS","elements":[{"elements":[{"text":"Linuxもそうだし、影響はないか...\nただE20は気になる","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"63fa305e-585a-4e84-998b-5c91ecc3cffe","type":"message","text":"<https://github.com/prabirshrestha/vim-lsp/blob/52539a54ae338993460205b4528d34caf175582e/autoload/lsp/client.vim#L102-L107>\nでE20?","user":"UAZ33BKV2","ts":"1585815129.157600","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","attachments":[{"service_name":"GitHub","title":"prabirshrestha/vim-lsp","title_link":"https://github.com/prabirshrestha/vim-lsp/blob/52539a54ae338993460205b4528d34caf175582e/autoload/lsp/client.vim#L102-L107","text":"async language server protocol plugin for vim and neovim - prabirshrestha/vim-lsp","fallback":"GitHub: prabirshrestha/vim-lsp","thumb_url":"https://avatars1.githubusercontent.com/u/287744?s=400&v=4","from_url":"https://github.com/prabirshrestha/vim-lsp/blob/52539a54ae338993460205b4528d34caf175582e/autoload/lsp/client.vim#L102-L107","thumb_width":400,"thumb_height":400,"service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","id":1,"original_url":"https://github.com/prabirshrestha/vim-lsp/blob/52539a54ae338993460205b4528d34caf175582e/autoload/lsp/client.vim#L102-L107"}],"blocks":[{"block_id":"E4n","elements":[{"elements":[{"type":"link","url":"https://github.com/prabirshrestha/vim-lsp/blob/52539a54ae338993460205b4528d34caf175582e/autoload/lsp/client.vim#L102-L107"},{"text":"\nでE20?","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"b246022f-e778-4a96-9a76-f7880839c9f9","type":"message","text":"どっかの行に素の `'` とか ` があるか探したけど、当然ないよなあ...関数呼び出し?","user":"UAZ33BKV2","ts":"1585815922.158500","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"mfY","elements":[{"elements":[{"text":"どっかの行に素の ","type":"text"},{"style":{"code":true},"text":"'","type":"text"},{"text":" とか ` があるか探したけど、当然ないよなあ...関数呼び出し?","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"3079b81e-aee9-458e-a063-f7adb9855430","type":"message","text":"<https://github.com/prabirshrestha/vim-lsp/blob/46308234a2691824f2f3ad1fa8bc0086d4a3d4cf/autoload/lsp/ui/vim/references.vim#L226>\nはあるが、呼ぶのはどこだ?","user":"UAZ33BKV2","ts":"1585817189.158800","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","attachments":[{"service_name":"GitHub","title":"prabirshrestha/vim-lsp","title_link":"https://github.com/prabirshrestha/vim-lsp/blob/46308234a2691824f2f3ad1fa8bc0086d4a3d4cf/autoload/lsp/ui/vim/references.vim#L226","text":"async language server protocol plugin for vim and neovim - prabirshrestha/vim-lsp","fallback":"GitHub: prabirshrestha/vim-lsp","thumb_url":"https://avatars1.githubusercontent.com/u/287744?s=400&v=4","from_url":"https://github.com/prabirshrestha/vim-lsp/blob/46308234a2691824f2f3ad1fa8bc0086d4a3d4cf/autoload/lsp/ui/vim/references.vim#L226","thumb_width":400,"thumb_height":400,"service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","id":1,"original_url":"https://github.com/prabirshrestha/vim-lsp/blob/46308234a2691824f2f3ad1fa8bc0086d4a3d4cf/autoload/lsp/ui/vim/references.vim#L226"}],"blocks":[{"block_id":"hFY4","elements":[{"elements":[{"type":"link","url":"https://github.com/prabirshrestha/vim-lsp/blob/46308234a2691824f2f3ad1fa8bc0086d4a3d4cf/autoload/lsp/ui/vim/references.vim#L226"},{"text":"\nはあるが、呼ぶのはどこだ?","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"aa46931f-5e6c-4dfa-b617-92e3fa575d76","type":"message","text":"`l:on_notification_data` を見せて貰えればどこに飛ぶのかわかるかもです。","user":"U03C6TEAZ","ts":"1585817616.159300","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"ZPqx","elements":[{"elements":[{"style":{"code":true},"text":"l:on_notification_data","type":"text"},{"text":" を見せて貰えればどこに飛ぶのかわかるかもです。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"1b67d984-f2d3-4820-9c12-77c37b118ed0","type":"message","text":"もしくはその例外部分で v:throwpoint を出力してみるとか。","user":"U03C6TEAZ","ts":"1585817737.159700","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"VzS","elements":[{"elements":[{"text":"もしくはその例外部分で v:throwpoint を出力してみるとか。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"ce20b8c7-a16c-4624-8546-f34988fd9bf3","type":"message","text":"ありがとうござます。\n前に上ってるログにありますが、切り出しますのでちょっとまってください","user":"UAZ33BKV2","ts":"1585817910.160300","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"gTT","elements":[{"elements":[{"text":"ありがとうござます。\n前に上ってるログにありますが、切り出しますのでちょっとまってください","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"7c7ee4c2-a95e-4754-b9b9-2e7bf979c783","type":"message","text":"ちょっと多めに切り出しました。\n直前はこの後にpostします。","user":"UAZ33BKV2","ts":"1585817983.160400","blocks":[{"block_id":"61+q","elements":[{"elements":[{"text":"ちょっと多めに切り出しました。\n直前はこの後にpostします。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}],"files":[{"id":"F011ACUDSP2","created":1585817981,"timestamp":1585817981,"name":"log","title":"split.log","mimetype":"application/octet-stream","filetype":"binary","pretty_type":"Binary","user":"UAZ33BKV2","editable":false,"size":6184,"mode":"hosted","is_external":false,"external_type":"","is_public":true,"public_url_shared":false,"display_as_bot":false,"username":"","url_private":"https://files.slack.com/files-pri/T03C4RC8V-F011ACUDSP2/log","url_private_download":"https://files.slack.com/files-pri/T03C4RC8V-F011ACUDSP2/download/log","permalink":"https://vim-jp.slack.com/files/UAZ33BKV2/F011ACUDSP2/log","permalink_public":"https://slack-files.com/T03C4RC8V-F011ACUDSP2-0503f315bf","is_starred":false,"has_rich_preview":false}],"upload":true},{"client_msg_id":"cf5be676-632e-4636-93fd-42a40245c5f9","type":"message","text":"```[{\"response\":{\"data\":{\"__data__\":\"vim-lsp\",\"server_name\":\"clangd\"},\"message\":\"configuration sent\"}}]\n[\"s:update_file_content()\",2]\n[\"---&gt;\",3,\"clangd\",{\"method\":\"textDocument/didOpen\",\"params\":{\"textDocument\":{\"uri\":\"file:///C:/Users/&lt;username&gt;/tmp/test.c\",\"version\":1,\"languageId\":\"c\",\"text\":\"#include &lt;stdio.h&gt;\\n\\nint\\nmain(int argc, char* argv[]) {\\n  // int a;\\n  printf();\\n  printf();\\n  printf();\\n  return 0;\\n}\\n\"}}}]\n[{\"response\":{\"data\":{\"path\":\"file:///C:/Users/&lt;username&gt;/tmp/test.c\",\"__data__\":\"vim-lsp\",\"filetype\":\"c\",\"server_name\":\"clangd\"},\"message\":\"textDocument/open sent\"}}]\n[{\"response\":{\"data\":{\"path\":\"file:///C:/Users/&lt;username&gt;/tmp/test.c\",\"__data__\":\"vim-lsp\",\"server_name\":\"clangd\"},\"message\":\"not dirty\"}}]\n[\"s:on_stdout client option on_notification() error\",\"Vim(call):E20: マークは設定されていません\"]```\nこんな風ですね","user":"UAZ33BKV2","ts":"1585818034.161000","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"Tro","elements":[{"elements":[{"text":"[{\"response\":{\"data\":{\"__data__\":\"vim-lsp\",\"server_name\":\"clangd\"},\"message\":\"configuration sent\"}}]\n[\"s:update_file_content()\",2]\n[\"--->\",3,\"clangd\",{\"method\":\"textDocument/didOpen\",\"params\":{\"textDocument\":{\"uri\":\"file:///C:/Users/<username>/tmp/test.c\",\"version\":1,\"languageId\":\"c\",\"text\":\"#include <stdio.h>\\n\\nint\\nmain(int argc, char* argv[]) {\\n  // int a;\\n  printf();\\n  printf();\\n  printf();\\n  return 0;\\n}\\n\"}}}]\n[{\"response\":{\"data\":{\"path\":\"file:///C:/Users/<username>/tmp/test.c\",\"__data__\":\"vim-lsp\",\"filetype\":\"c\",\"server_name\":\"clangd\"},\"message\":\"textDocument/open sent\"}}]\n[{\"response\":{\"data\":{\"path\":\"file:///C:/Users/<username>/tmp/test.c\",\"__data__\":\"vim-lsp\",\"server_name\":\"clangd\"},\"message\":\"not dirty\"}}]\n[\"s:on_stdout client option on_notification() error\",\"Vim(call):E20: マークは設定されていません\"]","type":"text"}],"type":"rich_text_preformatted"},{"elements":[{"text":"\nこんな風ですね","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"0c22b474-7278-42b2-a8b1-dfc35c7deab6","type":"message","text":"いっそ","user":"U03C6TEAZ","ts":"1585818209.161300","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"fhN","elements":[{"elements":[{"text":"いっそ","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"5156cf64-4719-4fe2-90ae-0c80bc6fc5a4","type":"message","text":"<https://github.com/prabirshrestha/vim-lsp/blob/52539a54ae338993460205b4528d34caf175582e/autoload/lsp/client.vim#L102-L107>","user":"U03C6TEAZ","ts":"1585818210.161500","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"9C+7","elements":[{"elements":[{"type":"link","url":"https://github.com/prabirshrestha/vim-lsp/blob/52539a54ae338993460205b4528d34caf175582e/autoload/lsp/client.vim#L102-L107"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"4b8ce4c1-597c-455b-8aac-793de1da8694","type":"message","text":"この try/catch はずせばどこで出てるか分かるかも。","user":"U03C6TEAZ","ts":"1585818221.161900","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"hXPV","elements":[{"elements":[{"text":"この try/catch はずせばどこで出てるか分かるかも。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"0c3fee5c-fbcc-4da0-92fa-e6492a19f956","type":"message","text":"あー、やってみます","user":"UAZ33BKV2","ts":"1585818248.162100","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"KUZx8","elements":[{"elements":[{"text":"あー、やってみます","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"b1d65a59-e254-4e50-8abe-88e1e297a028","type":"message","text":"```User Autocommands for \"lsp_server_init\" の処理中にエラーが検出されました:\nE20: マークは設定されていません\nE20: マークは設定されていません\nC:\\Users\\&lt;username&gt;\\.cache\\dein\\.cache\\.vimrc\\.dein\\autoload\\yoink.vim の処理中にエラーが検出されました:\n行   32:\nE117: 未知の関数です: cutlass#getVersion```\nおおう... yoinkとcutlass関係か","user":"UAZ33BKV2","ts":"1585818454.163600","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"9nl+","elements":[{"elements":[{"text":"User Autocommands for \"lsp_server_init\" の処理中にエラーが検出されました:\nE20: マークは設定されていません\nE20: マークは設定されていません\nC:\\Users\\<username>\\.cache\\dein\\.cache\\.vimrc\\.dein\\autoload\\yoink.vim の処理中にエラーが検出されました:\n行   32:\nE117: 未知の関数です: cutlass#getVersion","type":"text"}],"type":"rich_text_preformatted"},{"elements":[{"text":"\nおおう... yoinkとcutlass関係か","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"cd410d7f-3d3b-431b-ab67-f433e8a3bd70","type":"message","text":"はずしてみます","user":"UAZ33BKV2","ts":"1585818480.163900","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"Rud","elements":[{"elements":[{"text":"はずしてみます","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"0a17743b-a612-490b-8c94-f3a9b8cf9c27","type":"message","text":"そうなんすよ。その on_notification の try/catch、結構根深いところから飛んでくることが多くて、実は自分のコードだった、みたいなのをよく見たりします。","user":"U03C6TEAZ","ts":"1585818481.164000","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"x79gG","elements":[{"elements":[{"text":"そうなんすよ。その on_notification の try/catch、結構根深いところから飛んでくることが多くて、実は自分のコードだった、みたいなのをよく見たりします。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"cae23a1a-fc6c-44ba-bf8c-a1971e981980","type":"message","text":"これ、うまく呼び元をlogできないと辛いですね...","user":"UAZ33BKV2","ts":"1585818541.164600","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"i2P","elements":[{"elements":[{"text":"これ、うまく呼び元をlogできないと辛いですね...","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"65550dbe-92b7-4c5d-ac54-877a2dcae53f","type":"message","text":"v:throwpoint 入れた方が良さそう。","user":"U03C6TEAZ","ts":"1585818552.164900","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"Qnp","elements":[{"elements":[{"text":"v:throwpoint 入れた方が良さそう。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"48eb7add-b642-44e7-b16b-a82abec3bfb1","type":"message","text":"yoink でなぜエラーがｗ","user":"U8R597E9H","ts":"1585818556.165000","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"hw6v","elements":[{"elements":[{"text":"yoink でなぜエラーがｗ","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"a007d6ae-ab55-4d74-bbef-d3df3c927fe1","type":"message","text":"イベントがバブリングして全く関係ない所のエラーがさも vim-lsp のバグの様に出てしまう現象。","user":"U03C6TEAZ","ts":"1585818601.165800","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"d6j=","elements":[{"elements":[{"text":"イベントがバブリングして全く関係ない所のエラーがさも vim-lsp のバグの様に出てしまう現象。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"7ed6afab-abb8-45cb-a4e2-2b41e99eb0c1","type":"message","text":"<https://github.com/svermeulen/vim-yoink/blob/20daf7d4cdc6a36eba1b87b0f8849859d6e3b23c/autoload/yoink.vim#L30-L35>\nこのキャッチがよくないんかな","user":"UAZ33BKV2","ts":"1585818606.166000","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","attachments":[{"service_name":"GitHub","title":"svermeulen/vim-yoink","title_link":"https://github.com/svermeulen/vim-yoink/blob/20daf7d4cdc6a36eba1b87b0f8849859d6e3b23c/autoload/yoink.vim#L30-L35","text":"Vim plugin that maintains a yank history to cycle between when pasting - svermeulen/vim-yoink","fallback":"GitHub: svermeulen/vim-yoink","thumb_url":"https://avatars2.githubusercontent.com/u/810762?s=400&v=4","from_url":"https://github.com/svermeulen/vim-yoink/blob/20daf7d4cdc6a36eba1b87b0f8849859d6e3b23c/autoload/yoink.vim#L30-L35","thumb_width":400,"thumb_height":400,"service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","id":1,"original_url":"https://github.com/svermeulen/vim-yoink/blob/20daf7d4cdc6a36eba1b87b0f8849859d6e3b23c/autoload/yoink.vim#L30-L35"}],"blocks":[{"block_id":"29X","elements":[{"elements":[{"type":"link","url":"https://github.com/svermeulen/vim-yoink/blob/20daf7d4cdc6a36eba1b87b0f8849859d6e3b23c/autoload/yoink.vim#L30-L35"},{"text":"\nこのキャッチがよくないんかな","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"1dc76657-c65c-47dc-80b1-e0a5c722783b","type":"message","text":"ありがとうございます、前進しました。","user":"UAZ33BKV2","ts":"1585818644.166500","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"74/","elements":[{"elements":[{"text":"ありがとうございます、前進しました。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"type":"message","subtype":"channel_join","text":"<@U011AKJN7PZ> has joined the channel","user":"U011AKJN7PZ","ts":"1585819137.166700"},{"type":"message","subtype":"channel_leave","text":"<@UM8040TQW> has left the channel","user":"UM8040TQW","ts":"1585832472.167000"},{"client_msg_id":"f6ec5568-1e05-4562-997d-dd787057abc1","type":"message","text":"yoinkを切って(前のyankroundに戻して)、再度ログを取りましたら...\n\n```s:on_stdout client option on_notification() error Vim(call):E20: マークは設定されていません User Autocommands for \"lsp_server_init\"```\n今度は出所がわからないorz\n\n```                    \" call client's on_notification first\n                    try\n                      call l:ctx['opts']['on_notification'](a:id, l:on_notification_data, 'on_notification')\n                    catch\n                      echomsg 's:on_stdout client option on_notification() error' v:exception v:throwpoint\n                      call lsp#log('s:on_stdout client option on_notification() error', v:exception ,v:throwpoint)\n                    endtry```","user":"UAZ33BKV2","ts":"1585836587.168000","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"pbrt","elements":[{"elements":[{"text":"yoinkを切って(前のyankroundに戻して)、再度ログを取りましたら...\n\n","type":"text"}],"type":"rich_text_section"},{"elements":[{"text":"s:on_stdout client option on_notification() error Vim(call):E20: マークは設定されていません User Autocommands for \"lsp_server_init\"","type":"text"}],"type":"rich_text_preformatted"},{"elements":[{"text":"\n今度は出所がわからないorz\n\n","type":"text"}],"type":"rich_text_section"},{"elements":[{"text":"                    \" call client's on_notification first\n                    try\n                      call l:ctx['opts']['on_notification'](a:id, l:on_notification_data, 'on_notification')\n                    catch\n                      echomsg 's:on_stdout client option on_notification() error' v:exception v:throwpoint\n                      call lsp#log('s:on_stdout client option on_notification() error', v:exception ,v:throwpoint)\n                    endtry","type":"text"}],"type":"rich_text_preformatted"}],"type":"rich_text"}]},{"client_msg_id":"d02a17ab-ee95-4030-abb5-4a574f2f092f","type":"message","text":"ctxのログ取り中","user":"UAZ33BKV2","ts":"1585836676.168300","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"/ACj","elements":[{"elements":[{"text":"ctxのログ取り中","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"93a9f531-7fb7-473f-b9c1-5aa0501bd6d8","type":"message","text":"ええぇ...? on_notification時にE20になる処理なんてないんじゃ?","user":"UAZ33BKV2","ts":"1585836830.168400","blocks":[{"block_id":"5O7","elements":[{"elements":[{"text":"ええぇ...? on_notification時にE20になる処理なんてないんじゃ?","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}],"files":[{"id":"F010Y2HQQ02","created":1585836829,"timestamp":1585836829,"name":"messages.txt","title":"messages.txt","mimetype":"text/plain","filetype":"text","pretty_type":"Plain Text","user":"UAZ33BKV2","editable":true,"size":3707,"mode":"snippet","is_external":false,"external_type":"","is_public":true,"public_url_shared":false,"display_as_bot":false,"username":"","url_private":"https://files.slack.com/files-pri/T03C4RC8V-F010Y2HQQ02/messages.txt","url_private_download":"https://files.slack.com/files-pri/T03C4RC8V-F010Y2HQQ02/download/messages.txt","permalink":"https://vim-jp.slack.com/files/UAZ33BKV2/F010Y2HQQ02/messages.txt","permalink_public":"https://slack-files.com/T03C4RC8V-F010Y2HQQ02-e613238a53","edit_link":"https://vim-jp.slack.com/files/UAZ33BKV2/F010Y2HQQ02/messages.txt/edit","is_starred":false,"has_rich_preview":false}],"upload":true},{"client_msg_id":"712b0406-2007-47b5-b0fc-417ceec0f403","type":"message","text":"(efmは自前で登録とはいえ、いままで問題なかったけど(補完は動かないが))","user":"UAZ33BKV2","ts":"1585837002.169200","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"mNY","elements":[{"elements":[{"text":"(efmは自前で登録とはいえ、いままで問題なかったけど(補完は動かないが))","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"0eaaa392-e394-4dbf-838f-e3034b8c340a","type":"message","text":"うーんE20になる要素がなあ、on_notificationはlsp内の関数だよね...","user":"UAZ33BKV2","ts":"1585837341.169400","blocks":[{"block_id":"UXA","elements":[{"elements":[{"text":"うーんE20になる要素がなあ、on_notificationはlsp内の関数だよね...","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}],"files":[{"id":"F010Y3G6E5Q","created":1585837340,"timestamp":1585837340,"name":"messages2.txt","title":"messages2.txt","mimetype":"text/plain","filetype":"text","pretty_type":"Plain Text","user":"UAZ33BKV2","editable":true,"size":3557,"mode":"snippet","is_external":false,"external_type":"","is_public":true,"public_url_shared":false,"display_as_bot":false,"username":"","url_private":"https://files.slack.com/files-pri/T03C4RC8V-F010Y3G6E5Q/messages2.txt","url_private_download":"https://files.slack.com/files-pri/T03C4RC8V-F010Y3G6E5Q/download/messages2.txt","permalink":"https://vim-jp.slack.com/files/UAZ33BKV2/F010Y3G6E5Q/messages2.txt","permalink_public":"https://slack-files.com/T03C4RC8V-F010Y3G6E5Q-f925691516","edit_link":"https://vim-jp.slack.com/files/UAZ33BKV2/F010Y3G6E5Q/messages2.txt/edit","is_starred":false,"has_rich_preview":false}],"upload":true},{"client_msg_id":"c94e537d-f596-4b83-a949-dfb7b3349c74","type":"message","text":"funcitonでのダンプをログとして保存しにくいため、どうしたものか","user":"UAZ33BKV2","ts":"1585837386.170100","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"qIbd","elements":[{"elements":[{"text":"funcitonでのダンプをログとして保存しにくいため、どうしたものか","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"2a99d139-5f5b-40d8-9597-887eba468743","type":"message","text":"on_notification とは限らないです。","user":"U03C6TEAZ","ts":"1585837427.170600","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"2Jlza","elements":[{"elements":[{"text":"on_notification とは限らないです。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"c7030284-6fe5-4694-b834-723c00de80ac","type":"message","text":"あー、違うところで出してるかもなんですよね...","user":"UAZ33BKV2","ts":"1585837456.171300","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"C=3","elements":[{"elements":[{"text":"あー、違うところで出してるかもなんですよね...","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"e87042ec-4059-424f-a6ee-209be8713e3d","type":"message","text":"たしかに","user":"UAZ33BKV2","ts":"1585837458.171500","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"eDAVd","elements":[{"elements":[{"text":"たしかに","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"547f42fd-46e6-4730-b237-c0cd0c95a586","type":"message","text":"痕跡がなくてどうしたらいいか","user":"UAZ33BKV2","ts":"1585837471.171900","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"JMkj+","elements":[{"elements":[{"text":"痕跡がなくてどうしたらいいか","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"865c6442-0585-4bd1-a7ea-2bb6b334d212","type":"message","text":"try/catch 外してみても駄目ですか？","user":"U03C6TEAZ","ts":"1585837490.172400","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"pzS8","elements":[{"elements":[{"text":"try/catch 外してみても駄目ですか？","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"e963e3c4-5110-48f5-bd02-fd1e7a45f797","type":"message","text":"上のログは外したやつです(でyoinkも外した)","user":"UAZ33BKV2","ts":"1585837504.172900","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"R4Lt","elements":[{"elements":[{"text":"上のログは外したやつです(でyoinkも外した)","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"b01615f4-80c4-467c-9572-b463e9fc15aa","type":"message","text":"`:mes` ですか？","user":"U03C6TEAZ","ts":"1585837524.173100","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"Vb5ar","elements":[{"elements":[{"style":{"code":true},"text":":mes","type":"text"},{"text":" ですか？","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"78e1e40c-6a3c-4663-8bd2-4ecadd0fb1d1","type":"message","text":"はいそうです\n<https://vim-jp.slack.com/archives/CQ57P4XU4/p1585836587168000>","user":"UAZ33BKV2","ts":"1585837533.173400","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","attachments":[{"author_icon":"https://avatars.slack-edge.com/2018-05-31/373472791093_ed16847a152da533e013_48.png","author_name":"Tsuyoshi CHO","author_subname":"Tsuyoshi CHO","text":"yoinkを切って(前のyankroundに戻して)、再度ログを取りましたら...\n\n```s:on_stdout client option on_notification() error Vim(call):E20: マークは設定されていません User Autocommands for \"lsp_server_init\"```\n今度は出所がわからないorz\n\n```                    \" call client's on_notification first\n                    try\n                      call l:ctx['opts']['on_notification'](a:id, l:on_notification_data, 'on_notification')\n                    catch\n                      echomsg 's:on_stdout client option on_notification() error' v:exception v:throwpoint\n                      call lsp#log('s:on_stdout client option on_notification() error', v:exception ,v:throwpoint)\n                    endtry```","fallback":"[April 2nd, 2020 7:09 AM] tsuyoshi_cho: yoinkを切って(前のyankroundに戻して)、再度ログを取りましたら...\n\n```s:on_stdout client option on_notification() error Vim(call):E20: マークは設定されていません User Autocommands for \"lsp_server_init\"```\n今度は出所がわからないorz\n\n```                    \" call client's on_notification first\n                    try\n                      call l:ctx['opts']['on_notification'](a:id, l:on_notification_data, 'on_notification')\n                    catch\n                      echomsg 's:on_stdout client option on_notification() error' v:exception v:throwpoint\n                      call lsp#log('s:on_stdout client option on_notification() error', v:exception ,v:throwpoint)\n                    endtry```","from_url":"https://vim-jp.slack.com/archives/CQ57P4XU4/p1585836587168000","id":1,"original_url":"https://vim-jp.slack.com/archives/CQ57P4XU4/p1585836587168000","footer":"Posted in #lsp"}],"blocks":[{"block_id":"YfB2p","elements":[{"elements":[{"text":"はいそうです\n","type":"text"},{"type":"link","url":"https://vim-jp.slack.com/archives/CQ57P4XU4/p1585836587168000"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"a4af4022-5eac-4440-888e-4cfd9ae5b18a","type":"message","text":"一旦yankroundとefm-langserver-settingsも外そう","user":"UAZ33BKV2","ts":"1585837562.174000","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"98gN","elements":[{"elements":[{"text":"一旦yankroundとefm-langserver-settingsも外そう","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"78660cc6-d497-45f6-9d42-8410b44c1bda","type":"message","text":"この on_notification というのは、vim-lsp がサーバに対してリクエストを投げて、その応答を受け取る際のコールバックなんです。","user":"U03C6TEAZ","ts":"1585837603.174700","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"HeO","elements":[{"elements":[{"text":"この on_notification というのは、vim-lsp がサーバに対してリクエストを投げて、その応答を受け取る際のコールバックなんです。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"d4d68f10-2467-43fa-b925-6e28b4913dff","type":"message","text":"omni.vim なんかが `lsp#send_request` してる箇所に `on_notification` を設定していて、そこに `s:handle_xxxx` みたいな関数があり、それをコールバックにしてます。","user":"U03C6TEAZ","ts":"1585837655.176000","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"lc+N","elements":[{"elements":[{"text":"omni.vim なんかが ","type":"text"},{"style":{"code":true},"text":"lsp#send_request","type":"text"},{"text":" してる箇所に ","type":"text"},{"style":{"code":true},"text":"on_notification","type":"text"},{"text":" を設定していて、そこに ","type":"text"},{"style":{"code":true},"text":"s:handle_xxxx","type":"text"},{"text":" みたいな関数があり、それをコールバックにしてます。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"5a6f9acd-9595-48e9-8a70-4bcdd26dc841","type":"message","text":"はい","user":"UAZ33BKV2","ts":"1585837676.176300","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"AY/K","elements":[{"elements":[{"text":"はい","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"63466128-8814-4ed2-a178-70869a72baa5","type":"message","text":"(引数ダンプもログしました)","user":"UAZ33BKV2","ts":"1585837715.177300","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"in4X","elements":[{"elements":[{"text":"(引数ダンプもログしました)","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"b9e438c9-06f0-4a93-b28b-4a5d2b5df2d3","type":"message","text":"そこでは色んなコードが入っていて、例えば fold のイベントが発生する様な物も含まれるので、例えば fold を契機に何かするプラグインがあればそこでエラーが起きる可能性もあります。","user":"U03C6TEAZ","ts":"1585837719.177500","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"gVWh3","elements":[{"elements":[{"text":"そこでは色んなコードが入っていて、例えば fold のイベントが発生する様な物も含まれるので、例えば fold を契機に何かするプラグインがあればそこでエラーが起きる可能性もあります。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"526ba515-8b5b-4832-b390-d17789182dfa","type":"message","text":"うええ...そういえばfoldセットするようにしたりしたな\nそこも外したほうがいいかも","user":"UAZ33BKV2","ts":"1585837745.178000","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"sUAq9","elements":[{"elements":[{"text":"うええ...そういえばfoldセットするようにしたりしたな\nそこも外したほうがいいかも","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"43ef2fe1-48c2-4b46-aaee-4caf4344fea8","type":"message","text":"非同期イベントと大域脱出のコンフリクトががが..","user":"UAZ33BKV2","ts":"1585837839.179000","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"3ksf","elements":[{"elements":[{"text":"非同期イベントと大域脱出のコンフリクトががが..","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"548fd312-4025-469d-84c7-c41fff986830","type":"message","text":"こういうエラーか起きたときのデバッグは難しいすね。","user":"U03C6TEAZ","ts":"1585837858.179400","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"BGEu","elements":[{"elements":[{"text":"こういうエラーか起きたときのデバッグは難しいすね。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"b7820f41-8793-4f66-86de-348df70b0dc2","type":"message","text":"思いきって verbosefile を吐くのも手です。","user":"U03C6TEAZ","ts":"1585837912.180600","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"0JPJU","elements":[{"elements":[{"text":"思いきって verbosefile を吐くのも手です。","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"5f740189-ee8c-48c7-973d-bfe17ae46a8d","type":"message","text":"やろうかな...ただ起動した直後になるので、vimrcで先にセットしないとですね","user":"UAZ33BKV2","ts":"1585837936.181200","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"/Lj8","elements":[{"elements":[{"text":"やろうかな...ただ起動した直後になるので、vimrcで先にセットしないとですね","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}],"edited":{"user":"UAZ33BKV2","ts":"1585837963.000000"}},{"client_msg_id":"5cb32002-88e6-4a5a-8f29-5c8c0299a858","type":"message","text":"アドバイスありがとうございます","user":"UAZ33BKV2","ts":"1585838024.181600","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"1bfk","elements":[{"elements":[{"text":"アドバイスありがとうございます","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"80d290bf-ba77-47c6-a262-b7d72e82b3d8","type":"message","text":"clangd側でも出たのでefm-langserver自体は除外できそう(yankroundもか)","user":"UAZ33BKV2","ts":"1585839120.182200","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"EVoI","elements":[{"elements":[{"text":"clangd側でも出たのでefm-langserver自体は除外できそう(yankroundもか)","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"d9be9741-2569-4311-93be-9d6c1cabc04f","type":"message","text":"verbose出さないとですね","user":"UAZ33BKV2","ts":"1585839132.182600","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"=b0vd","elements":[{"elements":[{"text":"verbose出さないとですね","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]}]
