[{"client_msg_id":"5fb1e387-3e31-40b3-ad56-43c20d076e48","type":"message","text":"前提: rust で書いた CLI アプリケーションのバージョンを git タグから取得したい\n質問: どうすればよいでしょう？\n\n1. `git_version` みたいなの使ってビルド時に解決し CLI ではそれを使う（`Cargo.toml` の `version` は `0.1.0` とかで固定）\n2. 何かしらのすごい方法で `Cargo.toml` の `version` と Git のタグを同期して `CARGO_PKG_VERSION` とかを CLI で返す\n3. もっと良い方法","user":"U776661HA","ts":"1585012930.069800","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"HPj","elements":[{"elements":[{"text":"前提: rust で書いた CLI アプリケーションのバージョンを git タグから取得したい\n質問: どうすればよいでしょう？\n\n","type":"text"}],"type":"rich_text_section"},{"elements":[{"elements":[{"style":{"code":true},"text":"git_version","type":"text"},{"text":" みたいなの使ってビルド時に解決し CLI ではそれを使う（","type":"text"},{"style":{"code":true},"text":"Cargo.toml","type":"text"},{"text":" の ","type":"text"},{"style":{"code":true},"text":"version","type":"text"},{"text":" は ","type":"text"},{"style":{"code":true},"text":"0.1.0","type":"text"},{"text":" とかで固定）","type":"text"}],"type":"rich_text_section"},{"elements":[{"text":"何かしらのすごい方法で ","type":"text"},{"style":{"code":true},"text":"Cargo.toml","type":"text"},{"text":" の ","type":"text"},{"style":{"code":true},"text":"version","type":"text"},{"text":" と Git のタグを同期して ","type":"text"},{"style":{"code":true},"text":"CARGO_PKG_VERSION","type":"text"},{"text":" とかを CLI で返す","type":"text"}],"type":"rich_text_section"},{"elements":[{"text":"もっと良い方法","type":"text"}],"type":"rich_text_section"}],"indent":0,"style":"ordered","type":"rich_text_list"}],"type":"rich_text"}]},{"client_msg_id":"325004ea-b39e-4db6-a81d-0e0014209100","type":"message","text":"あー別に rust は Cargo 必須というわけではないから `Cargo.toml` の `version` とアプリケーションのバージョンは別か... ってことは 1. が最適解かなぁ....?","user":"U776661HA","ts":"1585013114.070900","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"KSYh1","elements":[{"elements":[{"text":"あー別に rust は Cargo 必須というわけではないから ","type":"text"},{"style":{"code":true},"text":"Cargo.toml","type":"text"},{"text":" の ","type":"text"},{"style":{"code":true},"text":"version","type":"text"},{"text":" とアプリケーションのバージョンは別か... ってことは 1. が最適解かなぁ....?","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"705a3b79-d4d0-4dfc-8f5c-361810007ce7","type":"message","text":"<https://www.reddit.com/r/rust/comments/aa95c5/cargo_package_version_from_git_tag/>","user":"U776661HA","ts":"1585013242.071100","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","attachments":[{"service_name":"reddit","title":"Cargo package version from git tag","title_link":"https://www.reddit.com/r/rust/comments/aa95c5/cargo_package_version_from_git_tag/","text":"Is there a way to define the package version as a git tag instead of in the Cargo.toml?","fallback":"reddit: Cargo package version from git tag","thumb_url":"https://www.redditstatic.com/new-icon.png","from_url":"https://www.reddit.com/r/rust/comments/aa95c5/cargo_package_version_from_git_tag/","thumb_width":256,"thumb_height":256,"service_icon":"http://www.redditstatic.com/desktop2x/img/favicon/apple-icon-57x57.png","id":1,"original_url":"https://www.reddit.com/r/rust/comments/aa95c5/cargo_package_version_from_git_tag/"}],"blocks":[{"block_id":"myOGd","elements":[{"elements":[{"type":"link","url":"https://www.reddit.com/r/rust/comments/aa95c5/cargo_package_version_from_git_tag/"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"5928e0ba-4bc1-4f3e-9022-e38701bab407","type":"message","text":"alacrittyはこうやってました\n<https://github.com/alacritty/alacritty/blob/4000ec04d89b9bd77995960d2a9da8fcad55e003/alacritty/build.rs#L29|https://github.com/alacritty/alacritty/blob/4000ec04d89b9bd77995960d2a9da8fcad55e003/alacritty/build.rs#L29>","user":"UEB17JJJE","ts":"1585013301.071800","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","attachments":[{"service_name":"GitHub","title":"alacritty/alacritty","title_link":"https://github.com/alacritty/alacritty/blob/4000ec04d89b9bd77995960d2a9da8fcad55e003/alacritty/build.rs#L29","text":"A cross-platform, GPU-accelerated terminal emulator - alacritty/alacritty","fallback":"GitHub: alacritty/alacritty","thumb_url":"https://repository-images.githubusercontent.com/51980455/c6857780-448b-11ea-95ed-00fdbc59eb0b","from_url":"https://github.com/alacritty/alacritty/blob/4000ec04d89b9bd77995960d2a9da8fcad55e003/alacritty/build.rs#L29","thumb_width":500,"thumb_height":250,"service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","id":1,"original_url":"https://github.com/alacritty/alacritty/blob/4000ec04d89b9bd77995960d2a9da8fcad55e003/alacritty/build.rs#L29"}],"blocks":[{"block_id":"bMhP","elements":[{"elements":[{"text":"alacrittyはこうやってました\n","type":"text"},{"text":"https://github.com/alacritty/alacritty/blob/4000ec04d89b9bd77995960d2a9da8fcad55e003/alacritty/build.rs#L29","type":"link","url":"https://github.com/alacritty/alacritty/blob/4000ec04d89b9bd77995960d2a9da8fcad55e003/alacritty/build.rs#L29"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"a2f12031-b59d-463a-9aec-8530e0dcbe8d","type":"message","text":"<https://github.com/alacritty/alacritty/blob/4000ec04d89b9bd77995960d2a9da8fcad55e003/alacritty/src/cli.rs#L76>","user":"U776661HA","ts":"1585013403.072100","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","attachments":[{"service_name":"GitHub","title":"alacritty/alacritty","title_link":"https://github.com/alacritty/alacritty/blob/4000ec04d89b9bd77995960d2a9da8fcad55e003/alacritty/src/cli.rs#L76","text":"A cross-platform, GPU-accelerated terminal emulator - alacritty/alacritty","fallback":"GitHub: alacritty/alacritty","thumb_url":"https://repository-images.githubusercontent.com/51980455/c6857780-448b-11ea-95ed-00fdbc59eb0b","from_url":"https://github.com/alacritty/alacritty/blob/4000ec04d89b9bd77995960d2a9da8fcad55e003/alacritty/src/cli.rs#L76","thumb_width":500,"thumb_height":250,"service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","id":1,"original_url":"https://github.com/alacritty/alacritty/blob/4000ec04d89b9bd77995960d2a9da8fcad55e003/alacritty/src/cli.rs#L76"}],"blocks":[{"block_id":"wBBk","elements":[{"elements":[{"type":"link","url":"https://github.com/alacritty/alacritty/blob/4000ec04d89b9bd77995960d2a9da8fcad55e003/alacritty/src/cli.rs#L76"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"d918041f-2562-45f4-b399-7bd2cd403c6b","type":"message","text":"なるほど...","user":"U776661HA","ts":"1585013408.072400","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"NKQvJ","elements":[{"elements":[{"text":"なるほど...","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"eb5b6c0c-3fc3-40e3-ae83-65f1556bed2b","type":"message","text":"<https://github.com/alacritty/alacritty/blob/4000ec04d89b9bd77995960d2a9da8fcad55e003/alacritty/Cargo.toml#L3>","user":"U776661HA","ts":"1585013424.072600","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","attachments":[{"service_name":"GitHub","title":"alacritty/alacritty","title_link":"https://github.com/alacritty/alacritty/blob/4000ec04d89b9bd77995960d2a9da8fcad55e003/alacritty/Cargo.toml#L3","text":"A cross-platform, GPU-accelerated terminal emulator - alacritty/alacritty","fallback":"GitHub: alacritty/alacritty","thumb_url":"https://repository-images.githubusercontent.com/51980455/c6857780-448b-11ea-95ed-00fdbc59eb0b","from_url":"https://github.com/alacritty/alacritty/blob/4000ec04d89b9bd77995960d2a9da8fcad55e003/alacritty/Cargo.toml#L3","thumb_width":500,"thumb_height":250,"service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","id":1,"original_url":"https://github.com/alacritty/alacritty/blob/4000ec04d89b9bd77995960d2a9da8fcad55e003/alacritty/Cargo.toml#L3"}],"blocks":[{"block_id":"t7L","elements":[{"elements":[{"type":"link","url":"https://github.com/alacritty/alacritty/blob/4000ec04d89b9bd77995960d2a9da8fcad55e003/alacritty/Cargo.toml#L3"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"84177474-8e42-4579-913c-7e63c4a6074d","type":"message","text":"`Cargo.toml` の `version` を手動管理した上で `GIT_HASH` があれば、そちらも表示する　的な運用ですね","user":"U776661HA","ts":"1585013497.073300","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"ogpNG","elements":[{"elements":[{"style":{"code":true},"text":"Cargo.toml","type":"text"},{"text":" の ","type":"text"},{"style":{"code":true},"text":"version","type":"text"},{"text":" を手動管理した上で ","type":"text"},{"style":{"code":true},"text":"GIT_HASH","type":"text"},{"text":" があれば、そちらも表示する　的な運用ですね","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"239f00b7-6fda-4824-bc6c-1173db52c492","type":"message","text":"<https://github.com/alacritty/alacritty/commit/4d9253bb8d6ca6044742ef874e8ff554f4e3b45e>\n\nできれば \"Bump version\" 的なコミットをしたくないw","user":"U776661HA","ts":"1585013527.073700","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","attachments":[{"service_name":"GitHub","title":"Bump version to 0.4.1 · alacritty/alacritty@4d9253b","title_link":"https://github.com/alacritty/alacritty/commit/4d9253bb8d6ca6044742ef874e8ff554f4e3b45e","text":"A cross-platform, GPU-accelerated terminal emulator - alacritty/alacritty","fallback":"GitHub: Bump version to 0.4.1 · alacritty/alacritty@4d9253b","thumb_url":"https://avatars0.githubusercontent.com/u/8886672?s=200&v=4","from_url":"https://github.com/alacritty/alacritty/commit/4d9253bb8d6ca6044742ef874e8ff554f4e3b45e","thumb_width":200,"thumb_height":200,"service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","id":1,"original_url":"https://github.com/alacritty/alacritty/commit/4d9253bb8d6ca6044742ef874e8ff554f4e3b45e"}],"blocks":[{"block_id":"8ncy","elements":[{"elements":[{"type":"link","url":"https://github.com/alacritty/alacritty/commit/4d9253bb8d6ca6044742ef874e8ff554f4e3b45e"},{"text":"\n\nできれば \"Bump version\" 的なコミットをしたくないw","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}],"reactions":[{"name":"wakaru","users":["U9S4G0LJW"],"count":1}]},{"client_msg_id":"d5d17286-c185-422f-9f3e-34287b73ef4d","type":"message","text":"crates.ioの登録があるから仕方ないですかねー","user":"UEB17JJJE","ts":"1585013592.074700","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"B3hy","elements":[{"elements":[{"text":"crates.ioの登録があるから仕方ないですかねー","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"687fd633-45ab-456e-9c82-f02421a51456","type":"message","text":"cargo release みたいなコマンドでラップするしかないか...","user":"U776661HA","ts":"1585013629.075000","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"iG0W","elements":[{"elements":[{"text":"cargo release みたいなコマンドでラップするしかないか...","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"c3107ff2-7db2-4665-925c-6cd81bd56361","type":"message","text":"やはり CLI のバージョンは Cargo パッケージのバージョンとは異なる、という立ち位置で考えるのが良さそうですね","user":"U776661HA","ts":"1585013707.075800","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"8tpP","elements":[{"elements":[{"text":"やはり CLI のバージョンは Cargo パッケージのバージョンとは異なる、という立ち位置で考えるのが良さそうですね","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"f90cbf1f-f1c9-4881-ac47-058e915de00b","type":"message","text":"<http://crates.io|crates.io> に登録するわけではないし..","user":"U776661HA","ts":"1585013724.076100","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","blocks":[{"block_id":"zSQWx","elements":[{"elements":[{"text":"crates.io","type":"link","url":"http://crates.io"},{"text":" に登録するわけではないし..","type":"text"}],"type":"rich_text_section"}],"type":"rich_text"}]},{"client_msg_id":"a18e5ed5-eaf0-490d-ace5-c3e22910782e","type":"message","text":"ひとまず `Cargo.toml` の `version` は `0.1.0` とかに固定して、別枠で <https://docs.rs/git-version/0.3.4/git_version/> とか使ってアプリケーションバージョンを定義することにしました :bow:","user":"U776661HA","ts":"1585014117.077400","team":"T03C4RC8V","user_team":"T03C4RC8V","source_team":"T03C4RC8V","attachments":[{"service_name":"docs.rs","title":"git_version - Rust","title_link":"https://docs.rs/git-version/0.3.4/git_version/","text":"API documentation for the Rust `git_version` crate.","fallback":"git_version - Rust","from_url":"https://docs.rs/git-version/0.3.4/git_version/","service_icon":"https://docs.rs/favicon-20200108-1.42.0-nightly-caa231d99.ico","id":1,"original_url":"https://docs.rs/git-version/0.3.4/git_version/"}],"blocks":[{"block_id":"vG9RB","elements":[{"elements":[{"text":"ひとまず ","type":"text"},{"style":{"code":true},"text":"Cargo.toml","type":"text"},{"text":" の ","type":"text"},{"style":{"code":true},"text":"version","type":"text"},{"text":" は ","type":"text"},{"style":{"code":true},"text":"0.1.0","type":"text"},{"text":" とかに固定して、別枠で ","type":"text"},{"type":"link","url":"https://docs.rs/git-version/0.3.4/git_version/"},{"text":" とか使ってアプリケーションバージョンを定義することにしました ","type":"text"},{"name":"bow","type":"emoji"}],"type":"rich_text_section"}],"type":"rich_text"}]}]
